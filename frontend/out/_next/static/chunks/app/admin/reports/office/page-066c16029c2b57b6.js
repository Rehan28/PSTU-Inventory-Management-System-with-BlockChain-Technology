(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6291],{35550:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(73365),n=r(1521),s=r(86170),i=r(58600),l=r(87812),o=r(63678),d=r(86414),c=r(2262),p=r(62041),x=r(20255),g=r.n(x);function m(){let[e,t]=(0,n.useState)(""),[r,x]=(0,n.useState)([]),[m,h]=(0,n.useState)([]),[f,u]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null),[j,v]=(0,n.useState)(!1),[N,w]=(0,n.useState)(!1),[k,_]=(0,n.useState)(!1),[S,C]=(0,n.useState)("");(0,n.useEffect)(()=>{_(!0)},[]),(0,n.useEffect)(()=>{if(!k)return;let e=()=>{C(new Date().toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[k]),(0,n.useEffect)(()=>{k&&(async()=>{try{let e=await fetch("http://localhost:5000/api/offices/get");if(e.ok){let t=await e.json();x(Array.isArray(t)?t:[])}}catch(e){console.error("[v0] Failed to fetch offices:",e)}})()},[k]),(0,n.useEffect)(()=>{e.trim().length>0?(h(r.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()))),u(!0)):(h([]),u(!1))},[e,r]);let A=e=>e.filter(e=>0!==e.stock_in||0!==e.stock_out||0!==e.dead_stock),F=async e=>{v(!0),t(""),h([]),u(!1);try{let t=await fetch("http://localhost:5000/api/items/get");if(!t.ok)throw Error("Failed to fetch items");let r=await t.json(),a=await fetch("http://localhost:5000/api/stockins/office/".concat(e._id)),n=await fetch("http://localhost:5000/api/stockouts/office/".concat(e._id)),s=await fetch("http://localhost:5000/api/deadstocks/office/".concat(e._id)),i={},l={},o={};if(a.ok){let e=await a.json();i=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}if(n.ok){let e=await n.json();l=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}if(s.ok){let e=await s.json();o=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}let d=r.map(e=>{let t=i[e._id]||0,r=l[e._id]||0,a=o[e._id]||0;return{...e,stock_in:t,stock_out:r,dead_stock:a,current_stock:t-r}}),c=A(d);b({...e,items:c})}catch(e){console.error("[v0] Failed to load office data:",e),alert("Failed to load office data. Please try again.")}finally{v(!1)}},P=async e=>{try{let t=await fetch(e,{mode:"cors",credentials:"omit",headers:{Accept:"image/*"}});if(!t.ok)return"";let r=await t.blob();return new Promise(e=>{let t=new FileReader;t.onloadend=()=>{let r=t.result;e(r)},t.onerror=()=>{e("")},t.readAsDataURL(r)})}catch(e){return""}},z=async()=>{if(y){w(!0);try{let e="";try{e=await P("/pstu_logo.jpeg")}catch(e){console.warn("[v0] Logo loading failed, continuing without logo")}let t=document.createElement("div");t.style.position="absolute",t.style.left="-9999px",t.style.width="900px",t.style.backgroundColor="white";let r=A(y.items).map((e,t)=>'\n        <tr>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center;">'.concat(t+1,'</td>\n          <td style="border:1px solid #ddd; padding:6px;">').concat(e.name||"N/A",'</td>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e8f5e9; font-weight:bold;">').concat(Number(e.stock_in)||0,'</td>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fce4ec; font-weight:bold;">').concat(Number(e.stock_out)||0,'</td>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fff3e0; font-weight:bold;">').concat(Number(e.dead_stock)||0,'</td>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e3f2fd; font-weight:bold;">').concat(Number(e.current_stock)||0,"</td>\n        </tr>\n      ")).join("");t.innerHTML='\n        <div style="font-family: Arial, sans-serif; padding: 20px; background-color: white;">\n          <div style="text-align:center; margin-bottom: 15px;">\n            '.concat(e?'<img src="'.concat(e,'" alt="PSTU Logo" style="width:90px; height:90px; border-radius:50%; margin:0 auto 10px; object-fit: cover; display:block; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" />'):'<div style="width:90px; height:90px; margin:0 auto 10px; background-color:#f0f0f0; border: 1px solid #ddd; display:flex; align-items:center; justify-content:center; font-size:10px; color:#999; border-radius:50%;">Logo</div>','\n          </div>\n\n          <div style="text-align:center; margin-bottom: 20px;">\n            <h2 style="color:#51247a; margin:5px 0; font-size: 18px;">পটুয়াখালী বিজ্ঞান ও প্রযুক্তি বিশ্ববিদ্যালয়</h2>\n            <h4 style="color:#666; margin:3px 0; font-size: 14px;">Patuakhali Science and Technology University</h4>\n            <h3 style="margin:10px 0; color:#51247a; font-size: 16px;">অফিস আইটেম রিপোর্ট</h3>\n            <hr style="border:1px solid #51247a; margin-top:10px;" />\n          </div>\n\n          <div style="margin-bottom: 20px; padding: 10px; background-color: #f5f5f5; border-radius: 5px;">\n            <p style="margin: 5px 0;"><strong>অফিসের নাম:</strong> ').concat(y.name,"</p>\n            ").concat(y.description?'<p style="margin: 5px 0;"><strong>বর্ণনা:</strong> '.concat(y.description,"</p>"):"","\n            ").concat(y.location?'<p style="margin: 5px 0;"><strong>অবস্থান:</strong> '.concat(y.location,"</p>"):"",'\n            <p style="margin: 5px 0;"><strong>রিপোর্ট তারিখ:</strong> ').concat(new Date().toLocaleString("bn-BD"),'</p>\n          </div>\n\n          <table style="width:100%; border-collapse:collapse; font-size:10px;">\n            <thead>\n              <tr style="background-color:#51247a; color:white;">\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ক্রমিক<br/>(Number)</th>\n                <th style="border:1px solid #ddd; padding:6px;">পণ্যের নাম<br/>(Item Name)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক ইন<br/>(Stock IN)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক আউট<br/>(Stock OUT)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ডেড স্টক<br/>(Dead Stock)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">বর্তমান স্টক<br/>(Current Stock)</th>\n              </tr>\n            </thead>\n            <tbody>\n              ').concat(r,'\n            </tbody>\n          </table>\n\n          <p style="text-align:center; margin-top:20px; font-size:10px;">\n            \xa9 ').concat(new Date().getFullYear()," Patuakhali Science and Technology University.\n          </p>\n        </div>\n      "),document.body.appendChild(t),await new Promise(e=>setTimeout(e,1200));let a=await g()(t,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff"}),n=a.toDataURL("image/png"),s=new p.Ay("p","mm","a4"),i=s.internal.pageSize.getWidth(),l=a.height*i/a.width;if(l>s.internal.pageSize.getHeight()){s.addImage(n,"PNG",0,0,i,l);let e=l-s.internal.pageSize.getHeight(),t=0;for(;e>0;)t=e-l,s.addPage(),s.addImage(n,"PNG",0,t,i,l),e-=s.internal.pageSize.getHeight()}else s.addImage(n,"PNG",0,0,i,l);s.save("office-report-".concat(y.name,"-").concat(new Date().toISOString().split("T")[0],".pdf")),document.body.removeChild(t)}catch(e){console.error("[v0] Failed to generate PDF:",e),alert("Failed to generate PDF. Please try again.")}finally{w(!1)}}};return k?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"w-full max-w-2xl space-y-6",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.Zp,{children:(0,a.jsx)(s.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 text-center justify-center",children:[(0,a.jsx)(d.A,{className:"w-5 h-5",style:{color:"#51247a"}}),(0,a.jsx)("div",{className:"text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-lg",children:S})]})})}),(0,a.jsx)(s.Zp,{children:(0,a.jsxs)(s.Wu,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",style:{color:"#51247a"},children:y.name}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[y.description&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"বর্ণনা:"})," ",y.description]}),y.location&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"অবস্থান:"})," ",y.location]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"মোট আইটেম:"})," ",y.items.length]})]})]})}),y.items.length>0?(0,a.jsx)(s.Zp,{children:(0,a.jsx)(s.Wu,{className:"p-6",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{backgroundColor:"#51247a"},className:"text-white",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"ক্রমিক"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"পণ্যের নাম"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"স্টক ইন"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"স্টক আউট"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"ডেড স্টক"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"বর্তমান স্টক"})]})}),(0,a.jsx)("tbody",{children:y.items.map((e,t)=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:t+1}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.name||"N/A"}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.stock_in)||0}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.stock_out)||0}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.dead_stock)||0}),(0,a.jsx)("td",{className:"px-4 py-3 text-center font-medium",children:Number(e.current_stock)||0})]},e._id))})]})})})}):(0,a.jsx)(s.Zp,{children:(0,a.jsx)(s.Wu,{className:"p-6 text-center text-gray-500",children:"এই অফিসের কোনো আইটেম নেই"})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(i.$,{onClick:z,disabled:N,className:"flex-1 text-white gap-2",style:{backgroundColor:"#51247a"},children:N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{className:"w-4 h-4 animate-spin"}),"তৈরি হচ্ছে..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{className:"w-4 h-4"}),"PDF ডাউনলোড করুন"]})}),(0,a.jsx)(i.$,{onClick:()=>{b(null),t("")},variant:"outline",children:"নতুন অনুসন্ধান"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",style:{color:"#51247a"},children:"অফিস রিপোর্ট"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Office Report - Search and generate reports by office"})]}),(0,a.jsx)(s.Zp,{children:(0,a.jsx)(s.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"relative space-y-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"অফিস খুঁজুন"}),(0,a.jsx)(l.p,{type:"text",placeholder:"অফিসের নাম লিখুন... (Search office name)",value:e,onChange:e=>t(e.target.value),onFocus:()=>e.trim().length>0&&u(!0),className:"w-full"}),f&&m.length>0&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-10 max-h-64 overflow-y-auto",children:m.map(e=>(0,a.jsxs)("button",{onClick:()=>F(e),className:"w-full text-left px-4 py-3 hover:bg-gray-50 border-b last:border-b-0 transition-colors",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]},e._id))}),f&&0===m.length&&e.trim().length>0&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-10 p-4 text-center text-gray-500 text-sm",children:"কোনো অফিস পাওয়া যায়নি"})]})})})]})})}):(0,a.jsx)("div",{className:"min-h-[200px] flex items-center justify-center",children:(0,a.jsx)(o.A,{className:"w-6 h-6 animate-spin"})})}},55337:(e,t,r)=>{Promise.resolve().then(r.bind(r,35550))},58600:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var a=r(73365),n=r(1521),s=r(20544),i=r(82934),l=r(69671);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:i,asChild:d=!1,...c}=e,p=d?s.DX:"button";return(0,a.jsx)(p,{className:(0,l.cn)(o({variant:n,size:i,className:r})),ref:t,...c})});d.displayName="Button"},69671:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var a=r(74584),n=r(22292);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,a.$)(t))}},86170:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>i,aR:()=>l});var a=r(73365),n=r(1521),s=r(69671);let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});i.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...n})});l.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});o.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter"},87812:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var a=r(73365),n=r(1521),s=r(69671);let i=n.forwardRef((e,t)=>{let{className:r,type:n,...i}=e;return(0,a.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"}},e=>{var t=t=>e(e.s=t);e.O(0,[5501,8262,5484,3096,2498,2347,4870,7358],()=>t(55337)),_N_E=e.O()}]);