(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3183],{31836:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>N});var a=t(73365),s=t(31130),i=t.n(s),l=t(1521),o=t(86170),n=t(58600),d=t(87812),c=t(72770),u=t(67674),m=t(39386),f=t(1941),p=t(81849),x=t(53441),b=t(24209),g=t(59534),h=t.n(g),v=t(25826);function N(){let[e,r]=(0,l.useState)({id:"",name:"",email:"",department:"",office:""}),[t,s]=(0,l.useState)({productName:"",invoiceNumber:"",quantity:"",unitPrice:"",description:"",supplier:"",requestedByName:""}),[g,N]=(0,l.useState)([]),[y,j]=(0,l.useState)([]),[w,C]=(0,l.useState)(!1),[q,k]=(0,l.useState)(!1),[S,P]=(0,l.useState)([]),[F,R]=(0,l.useState)([]),[B,I]=(0,l.useState)(null),[E,_]=(0,l.useState)(""),[D,A]=(0,l.useState)(!1),[J,T]=(0,l.useState)(!1),[O,z]=(0,l.useState)({}),[L,U]=(0,l.useState)(""),$=(0,l.useRef)(null),Q=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=localStorage.getItem("userId"),t=localStorage.getItem("userName")||"",a=localStorage.getItem("userEmail")||"";r({id:e||"",name:t,email:a,department:localStorage.getItem("userDepartment")||"",office:localStorage.getItem("userOffice")||""}),s(e=>({...e,requestedByName:t})),(async()=>{try{let[e,r]=await Promise.all([fetch("http://localhost:5000/api/items/get"),fetch("http://localhost:5000/api/suppliers/get")]);if(e.ok){let r=await e.json(),t=(Array.isArray(r)?r:r.data||r.items||[]).map(e=>({id:e.id||e._id||"",name:e.itemName||e.name||""}));N(t)}else console.warn("Failed to fetch items",e.status);if(r.ok){let e=await r.json(),t=(Array.isArray(e)?e:e.data||e.suppliers||[]).map(e=>({id:e.id||e._id||"",name:e.supplierName||e.name||e}));j(t)}else console.warn("Failed to fetch suppliers",r.status)}catch(e){console.error("Error fetching products or suppliers:",e)}})()},[]);let V=e=>{if(H("productName",e),e.trim().length>0){let r=g.filter(r=>r.name.toLowerCase().includes(e.toLowerCase()));P(r),C(r.length>0)}else C(!1),P([])},Z=e=>{if(H("supplier",e),e.trim().length>0){let r=y.filter(r=>r.name.toLowerCase().includes(e.toLowerCase()));R(r),k(r.length>0)}else k(!1),R([])},G=e=>{s(r=>({...r,productName:e.name})),C(!1),P([]),z(e=>{let r={...e};return delete r.productName,r})},Y=e=>{s(r=>({...r,supplier:e.name})),k(!1),R([]),z(e=>{let r={...e};return delete r.supplier,r})},M=()=>{let r={};t.productName.trim()||(r.productName="Product name is required"),t.invoiceNumber.trim()||(r.invoiceNumber="Invoice number is required");let a=t.quantity.trim();if(a){let e=Number(a);(isNaN(e)||e<=0)&&(r.quantity="Quantity must be a positive number")}else r.quantity="Quantity is required";let s=t.unitPrice.trim();if(s){let e=Number(s);(isNaN(e)||e<=0)&&(r.unitPrice="Unit price must be a positive number")}else r.unitPrice="Unit price is required";return t.supplier.trim()||(r.supplier="Supplier name is required"),B||(r.image="Product image is required"),e.id&&"undefined"!==e.id&&""!==e.id.trim()||(r.user="User information not found. Please log in again."),z(r),0===Object.keys(r).length},W=e=>{var r;let t=null===(r=e.target.files)||void 0===r?void 0:r[0];if(t){if(t.size>5242880){z(e=>({...e,image:"Image must be 5MB or smaller"}));return}I(t);let e=new FileReader;e.onloadend=()=>{_(e.result),O.image&&z(e=>({...e,image:""}))},e.readAsDataURL(t)}},X=async r=>{if(r.preventDefault(),U(""),T(!1),M()){if(!e.id||"undefined"===e.id||""===e.id.trim()){U("Error: User ID not found. Please log in again.");return}if(!B){U("Error: Please select an image file.");return}A(!0);try{var a;let r;let i=g.find(e=>e.name===t.productName),l=y.find(e=>e.name===t.supplier),o=new FormData,n=null===(a=e.id)||void 0===a?void 0:a.toString(),d=(null==i?void 0:i.id)||t.productName,c=t.invoiceNumber,u=Number.parseInt(t.quantity),m=Number.parseFloat(t.unitPrice),f=u*m,p=(null==l?void 0:l.id)||t.supplier,x=t.description||"";o.append("user_id",n),o.append("item_id",d),o.append("invoice_no",c),o.append("quantity",u.toString()),o.append("unit_price",m.toString()),o.append("total_price",f.toString()),o.append("supplier_id",p),o.append("description",x),o.append("image",B),console.log("[v1] Submitting stock-in request:",{user_id:n,item_id:d,invoice_no:c,quantity:u,unit_price:m,total_price:f,supplier_id:p,description:x,imageName:B.name});let b=await fetch("http://localhost:5000/api/stockInRequest/create",{method:"POST",body:o}),h=await b.text();console.log("[v1] Raw response text:",h),console.log("[v1] Response status:",b.status);try{r=JSON.parse(h)}catch(e){console.error("[v1] Failed to parse response as JSON",e),U("Server error (".concat(b.status,"): ").concat(h||"No response body")),A(!1);return}if(!b.ok){console.error("[v1] Backend returned error:",r);let e=r.message||r.error||"Error submitting form. Please try again.";r.errors&&console.error("[v1] Validation errors from server:",r.errors),U(e);return}console.log("[v1] Success response:",r),T(!0),s({productName:"",invoiceNumber:"",quantity:"",unitPrice:"",description:"",supplier:"",requestedByName:e.name}),I(null),_(""),z({})}catch(e){console.error("[v1] Error submitting form:",e),U(e instanceof Error?e.message:"An error occurred. Please try again.")}finally{A(!1)}}},H=(e,r)=>{s(t=>({...t,[e]:r})),O[e]&&z(r=>{let t={...r};return delete t[e],t})};return(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a max-w-4xl mx-auto p-4",children:[(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a mb-6",children:[(0,a.jsx)("div",{className:"jsx-3f31047bf4793a0a flex items-center space-x-4 mb-4",children:(0,a.jsx)(h(),{href:"/",children:(0,a.jsxs)(n.$,{variant:"outline",size:"sm",className:"bg-transparent",style:{borderColor:"#e7e7e7",color:"#51247a"},children:[(0,a.jsx)(f.A,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]})})}),(0,a.jsx)("h2",{style:{color:"#51247a"},className:"jsx-3f31047bf4793a0a text-2xl font-bold mb-2",children:"Request Stock In"}),(0,a.jsx)("p",{style:{color:"#666"},className:"jsx-3f31047bf4793a0a",children:"Submit a new stock in request for admin approval"})]}),(0,a.jsxs)(o.Zp,{style:{borderColor:"#e7e7e7",backgroundColor:"#ffffff"},children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{style:{color:"#51247a"},children:"Stock In Request Details"}),(0,a.jsx)(o.BT,{style:{color:"#666"},children:"Fill in all required fields. Your request will be reviewed by the admin."})]}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("form",{onSubmit:X,className:"jsx-3f31047bf4793a0a space-y-6",children:[(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"requestedByName",style:{color:"#51247a"},children:"Your Name *"}),(0,a.jsx)(d.p,{id:"requestedByName",value:t.requestedByName,onChange:e=>H("requestedByName",e.target.value),placeholder:"Enter your full name",className:O.requestedByName?"border-red-300":"",style:{borderColor:O.requestedByName?"#ef4444":"#e7e7e7"}}),O.requestedByName&&(0,a.jsx)("p",{className:"jsx-3f31047bf4793a0a text-sm text-red-600",children:O.requestedByName})]}),(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a space-y-2 relative",children:[(0,a.jsx)(c.J,{htmlFor:"productName",style:{color:"#51247a"},children:"Product Name *"}),(0,a.jsx)(d.p,{id:"productName",ref:$,value:t.productName,onChange:e=>V(e.target.value),onFocus:()=>t.productName&&C(!0),placeholder:"Enter or select product name",autoComplete:"off",style:{borderColor:O.productName?"#ef4444":"#e7e7e7"}}),w&&S.length>0&&(0,a.jsx)("div",{style:{borderColor:"#e7e7e7"},className:"jsx-3f31047bf4793a0a absolute top-full left-0 right-0 mt-1 bg-white border rounded-md shadow-lg z-10",children:S.slice(0,8).map((e,r)=>(0,a.jsx)("button",{type:"button",onClick:()=>G(e),className:"jsx-3f31047bf4793a0a w-full text-left px-3 py-2 hover:bg-gray-100",children:(0,a.jsx)("div",{style:{color:"#51247a"},className:"jsx-3f31047bf4793a0a font-medium",children:e.name})},r))}),O.productName&&(0,a.jsx)("p",{className:"jsx-3f31047bf4793a0a text-sm text-red-600",children:O.productName})]}),(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"invoiceNumber",style:{color:"#51247a"},children:"Invoice Number *"}),(0,a.jsx)(d.p,{id:"invoiceNumber",value:t.invoiceNumber,onChange:e=>H("invoiceNumber",e.target.value),placeholder:"e.g., INV-001",style:{borderColor:O.invoiceNumber?"#ef4444":"#e7e7e7"}}),O.invoiceNumber&&(0,a.jsx)("p",{className:"jsx-3f31047bf4793a0a text-sm text-red-600",children:O.invoiceNumber})]})]}),(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"quantity",style:{color:"#51247a"},children:"Quantity *"}),(0,a.jsx)(d.p,{id:"quantity",type:"number",value:t.quantity,onChange:e=>H("quantity",e.target.value),placeholder:"Enter quantity",style:{borderColor:O.quantity?"#ef4444":"#e7e7e7"}}),O.quantity&&(0,a.jsx)("p",{className:"jsx-3f31047bf4793a0a text-sm text-red-600",children:O.quantity})]}),(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"unitPrice",style:{color:"#51247a"},children:"Unit Price (BDT) *"}),(0,a.jsx)(d.p,{id:"unitPrice",type:"number",value:t.unitPrice,onChange:e=>H("unitPrice",e.target.value),placeholder:"Enter unit price",style:{borderColor:O.unitPrice?"#ef4444":"#e7e7e7"}}),O.unitPrice&&(0,a.jsx)("p",{className:"jsx-3f31047bf4793a0a text-sm text-red-600",children:O.unitPrice})]})]}),(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a space-y-2 relative",children:[(0,a.jsx)(c.J,{htmlFor:"supplier",style:{color:"#51247a"},children:"Supplier Name *"}),(0,a.jsx)(d.p,{id:"supplier",ref:Q,value:t.supplier,onChange:e=>Z(e.target.value),onFocus:()=>t.supplier&&k(!0),placeholder:"Enter or select supplier name",autoComplete:"off",style:{borderColor:O.supplier?"#ef4444":"#e7e7e7"}}),q&&F.length>0&&(0,a.jsx)("div",{style:{borderColor:"#e7e7e7"},className:"jsx-3f31047bf4793a0a absolute top-full left-0 right-0 mt-1 bg-white border rounded-md shadow-lg z-10",children:F.slice(0,8).map((e,r)=>(0,a.jsx)("button",{type:"button",onClick:()=>Y(e),style:{color:"#51247a"},className:"jsx-3f31047bf4793a0a w-full text-left px-3 py-2 hover:bg-gray-100",children:e.name},r))}),O.supplier&&(0,a.jsx)("p",{className:"jsx-3f31047bf4793a0a text-sm text-red-600",children:O.supplier})]}),(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"description",style:{color:"#51247a"},children:"Product Description"}),(0,a.jsx)(u.T,{id:"description",value:t.description,onChange:e=>H("description",e.target.value),placeholder:"Enter product description (optional)",style:{borderColor:"#e7e7e7"}})]}),(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"image",style:{color:"#51247a"},children:"Product Image *"}),(0,a.jsx)("div",{style:{borderColor:O.image?"#ef4444":"#e7e7e7"},onClick:()=>{var e;return null===(e=document.getElementById("imageInput"))||void 0===e?void 0:e.click()},onDragOver:e=>e.preventDefault(),onDrop:e=>{var r;e.preventDefault();let t=null===(r=e.dataTransfer.files)||void 0===r?void 0:r[0];t&&W({target:{files:[t]}})},className:"jsx-3f31047bf4793a0a border-2 border-dashed rounded-lg p-6 text-center cursor-pointer hover:bg-gray-50",children:E?(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a relative inline-block",children:[(0,a.jsx)(v.default,{src:E||"/placeholder.svg",alt:"Preview",width:200,height:200,className:"max-w-xs max-h-xs rounded"}),(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),I(null),_("")},className:"jsx-3f31047bf4793a0a absolute top-0 right-0 bg-red-500 text-white rounded-full p-1",children:"\xd7"})]}):(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a",children:[(0,a.jsx)(p.A,{className:"w-8 h-8 mx-auto mb-2",style:{color:"#51247a"}}),(0,a.jsx)("p",{style:{color:"#51247a"},className:"jsx-3f31047bf4793a0a font-medium",children:"Click to upload or drag and drop"}),(0,a.jsx)("p",{style:{color:"#999"},className:"jsx-3f31047bf4793a0a text-sm",children:"PNG, JPG or GIF (max. 5MB)"})]})}),(0,a.jsx)("input",{id:"imageInput",type:"file",accept:"image/*",onChange:W,className:"jsx-3f31047bf4793a0a hidden"}),O.image&&(0,a.jsx)("p",{className:"jsx-3f31047bf4793a0a text-sm text-red-600",children:O.image})]}),L&&(0,a.jsx)(m.Fc,{className:"border-red-300 bg-red-50",children:(0,a.jsx)(m.TN,{style:{color:"#dc2626"},children:L})}),J&&(0,a.jsx)(m.Fc,{className:"border-green-300 bg-green-50",style:{borderColor:"#22c55e",backgroundColor:"#f0fdf4"},children:(0,a.jsx)(m.TN,{style:{color:"#16a34a"},children:"Stock in request submitted successfully! Your request is now pending admin approval."})}),(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a flex gap-3",children:[(0,a.jsxs)(n.$,{type:"submit",disabled:D,className:"flex-1",style:{backgroundColor:"#51247a",color:"white",opacity:D?.7:1},children:[(0,a.jsx)(x.A,{className:"w-4 h-4 mr-2"}),D?"Submitting...":"Submit Request"]}),(0,a.jsxs)(n.$,{type:"button",variant:"outline",onClick:()=>{s({productName:"",invoiceNumber:"",quantity:"",unitPrice:"",description:"",supplier:"",requestedByName:e.name}),I(null),_(""),z({}),T(!1),U("")},style:{borderColor:"#e7e7e7",color:"#51247a"},children:[(0,a.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"Clear Form"]})]})]})})]}),(0,a.jsx)(i(),{id:"3f31047bf4793a0a",children:".suggestion-item.jsx-3f31047bf4793a0a:hover{background:#f7f7fb}"}),"true"===localStorage.getItem("debug")&&(0,a.jsxs)("div",{className:"jsx-3f31047bf4793a0a mt-4 p-4 border rounded bg-gray-50",children:[(0,a.jsx)("h3",{className:"jsx-3f31047bf4793a0a font-semibold mb-2",children:"Debug Info"}),(0,a.jsx)("pre",{className:"jsx-3f31047bf4793a0a text-xs",children:JSON.stringify({currentUser:e,formData:t,productsCount:g.length,suppliersCount:y.length},null,2)})]})]})}},39386:(e,r,t)=>{"use strict";t.d(r,{Fc:()=>n,TN:()=>c,XL:()=>d});var a=t(73365),s=t(1521),i=t(82934),l=t(69671);let o=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),n=s.forwardRef((e,r)=>{let{className:t,variant:s,...i}=e;return(0,a.jsx)("div",{ref:r,role:"alert",className:(0,l.cn)(o({variant:s}),t),...i})});n.displayName="Alert";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h5",{ref:r,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",t),...s})});d.displayName="AlertTitle";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",t),...s})});c.displayName="AlertDescription"},58600:(e,r,t)=>{"use strict";t.d(r,{$:()=>d});var a=t(73365),s=t(1521),i=t(20544),l=t(82934),o=t(69671);let n=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,r)=>{let{className:t,variant:s,size:l,asChild:d=!1,...c}=e,u=d?i.DX:"button";return(0,a.jsx)(u,{className:(0,o.cn)(n({variant:s,size:l,className:t})),ref:r,...c})});d.displayName="Button"},67674:(e,r,t)=>{"use strict";t.d(r,{T:()=>l});var a=t(73365),s=t(1521),i=t(69671);let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...s})});l.displayName="Textarea"},69671:(e,r,t)=>{"use strict";t.d(r,{cn:()=>i});var a=t(74584),s=t(22292);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.QP)((0,a.$)(r))}},72770:(e,r,t)=>{"use strict";t.d(r,{J:()=>d});var a=t(73365),s=t(1521),i=t(25092),l=t(82934),o=t(69671);let n=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(i.b,{ref:r,className:(0,o.cn)(n(),t),...s})});d.displayName=i.b.displayName},86170:(e,r,t)=>{"use strict";t.d(r,{BT:()=>d,Wu:()=>c,ZB:()=>n,Zp:()=>l,aR:()=>o});var a=t(73365),s=t(1521),i=t(69671);let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});l.displayName="Card";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...s})});o.displayName="CardHeader";let n=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});n.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},87812:(e,r,t)=>{"use strict";t.d(r,{p:()=>l});var a=t(73365),s=t(1521),i=t(69671);let l=s.forwardRef((e,r)=>{let{className:t,type:s,...l}=e;return(0,a.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...l})});l.displayName="Input"},94996:(e,r,t)=>{Promise.resolve().then(t.bind(t,31836))}},e=>{var r=r=>e(e.s=r);e.O(0,[3096,9924,4854,2347,4870,7358],()=>r(94996)),_N_E=e.O()}]);