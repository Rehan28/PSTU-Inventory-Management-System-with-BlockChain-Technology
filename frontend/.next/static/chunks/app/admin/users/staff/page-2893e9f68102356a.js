(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1428],{20958:(e,s,a)=>{Promise.resolve().then(a.bind(a,64475))},37216:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(87982).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},64475:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var l=a(73365),t=a(1521),r=a(86170),i=a(58600),n=a(87812),c=a(10096),d=a(69060),o=a(37896),m=a(23060),f=a(63678),x=a(37216),h=a(96872),j=a(67228),u=a(16296),p=a(60531),N=a(27521),g=a(59534),y=a.n(g);function b(){let[e,s]=(0,t.useState)([]),[a,g]=(0,t.useState)(!0),[b,v]=(0,t.useState)(""),[w,C]=(0,t.useState)("All Offices"),[A,S]=(0,t.useState)([]),[k,E]=(0,t.useState)(["All Offices"]),[_,M]=(0,t.useState)(""),[L,O]=(0,t.useState)(!1),[F,q]=(0,t.useState)(null),[$,W]=(0,t.useState)({name:"",email:"",phone:"",designation:"",qualification:""}),[Z,P]=(0,t.useState)(!1),[T,z]=(0,t.useState)(null);(0,t.useEffect)(()=>{(async()=>{try{g(!0),M("");let e=await fetch("http://localhost:5000/api/users/get-staff");if(!e.ok)throw Error("Failed to fetch staff");let a=await e.json(),l=await fetch("http://localhost:5000/api/offices/get");if(!l.ok)throw Error("Failed to fetch offices");let t=await l.json(),r=new Map(t.map(e=>[e._id,e])),i=a.map(e=>{let s=e.office_id?r.get(e.office_id):null;return{...e,officeName:(null==s?void 0:s.name)||"N/A",officeSection:(null==s?void 0:s.section)||"N/A"}}),n=["All Offices",...t.map(e=>e.name)];s(i),S(i),E(n)}catch(e){console.error("Error fetching data:",e),M(e instanceof Error?e.message:"Failed to load data")}finally{g(!1)}})()},[]);let B=e=>{v(e),H(e,w)},H=(s,a)=>{let l=e;s&&(l=l.filter(e=>e.name.toLowerCase().includes(s.toLowerCase())||e.email.toLowerCase().includes(s.toLowerCase())||e.officeName.toLowerCase().includes(s.toLowerCase())||e.officeSection.toLowerCase().includes(s.toLowerCase()))),"All Offices"!==a&&(l=l.filter(e=>e.officeName===a)),S(l)},U=e=>{q(e),W({name:e.name||"",email:e.email||"",phone:e.phone||"",designation:e.designation||"",qualification:e.qualification||""}),O(!0)},D=async()=>{if(F)try{P(!0);let e=await fetch("http://localhost:5000/api/users/update/".concat(F._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify($)});if(!e.ok)throw Error("Failed to update staff member");let a=await e.json();s(e=>e.map(e=>e._id===F._id?{...e,...a}:e)),S(e=>e.map(e=>e._id===F._id?{...e,...a}:e)),O(!1),q(null),alert("Staff member updated successfully!")}catch(e){console.error("Error updating staff member:",e),alert(e instanceof Error?e.message:"Failed to update staff member")}finally{P(!1)}},R=async e=>{if(confirm("Are you sure you want to delete this staff member?"))try{if(z(e),(await fetch("http://localhost:5000/api/users/delete/".concat(e),{method:"DELETE"})).ok)s(s=>s.filter(s=>s._id!==e)),S(s=>s.filter(s=>s._id!==e)),alert("Staff member deleted successfully!");else throw Error("Failed to delete staff member")}catch(e){console.error("Error deleting staff member:",e),alert(e instanceof Error?e.message:"Failed to delete staff member")}finally{z(null)}};return a?(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold",style:{color:"#51247a"},children:"Staff Management"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage and view all staff members"})]}),(0,l.jsx)(y(),{href:"/admin/staff/create",children:(0,l.jsxs)(i.$,{className:"text-white hover:bg-purple-700 flex items-center",style:{backgroundColor:"#51247a"},children:[(0,l.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Add Staff"]})})]}),(0,l.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(f.A,{className:"w-8 h-8 animate-spin mx-auto mb-4",style:{color:"#51247a"}}),(0,l.jsx)("p",{className:"text-gray-600",children:"Loading staff..."})]})})]}):_?(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold",style:{color:"#51247a"},children:"Staff Management"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage and view all staff members"})]}),(0,l.jsx)(y(),{href:"/admin/staff/create",children:(0,l.jsxs)(i.$,{className:"text-white hover:bg-purple-700 flex items-center",style:{backgroundColor:"#51247a"},children:[(0,l.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Add Staff"]})})]}),(0,l.jsx)(r.Zp,{style:{borderColor:"#e7e7e7",backgroundColor:"#ffffff"},children:(0,l.jsx)(r.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"text-center text-red-600",children:[(0,l.jsx)("p",{className:"font-medium",children:"Error loading data"}),(0,l.jsx)("p",{className:"text-sm mt-1",children:_}),(0,l.jsx)(i.$,{onClick:()=>window.location.reload(),className:"mt-4",variant:"outline",children:"Retry"})]})})})]}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold",style:{color:"#51247a"},children:"Staff Management"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage and view all staff members"})]}),(0,l.jsx)(y(),{href:"/admin/staff/create",children:(0,l.jsxs)(i.$,{className:"text-white hover:bg-purple-700 flex items-center",style:{backgroundColor:"#51247a"},children:[(0,l.jsx)(m.A,{className:"w-4 h-4 mr-2"}),"Add Staff"]})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsx)(r.Zp,{style:{borderColor:"#e7e7e7",backgroundColor:"#ffffff"},children:(0,l.jsx)(r.Wu,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Total Staff"}),(0,l.jsx)("p",{className:"text-2xl font-bold",style:{color:"#51247a"},children:e.length})]}),(0,l.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"#f3e8ff"},children:(0,l.jsx)(x.A,{className:"w-4 h-4 text-purple-600"})})]})})}),(0,l.jsx)(r.Zp,{style:{borderColor:"#e7e7e7",backgroundColor:"#ffffff"},children:(0,l.jsx)(r.Wu,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"With Phone Numbers"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-green-600",children:e.filter(e=>e.phone&&""!==e.phone.trim()).length})]}),(0,l.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(h.A,{className:"w-4 h-4 text-green-600"})})]})})}),(0,l.jsx)(r.Zp,{style:{borderColor:"#e7e7e7",backgroundColor:"#ffffff"},children:(0,l.jsx)(r.Wu,{className:"p-4",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Offices"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:new Set(e.map(e=>e.officeName).filter(e=>"N/A"!==e)).size})]}),(0,l.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,l.jsx)(j.A,{className:"w-4 h-4 text-blue-600"})})]})})})]}),(0,l.jsxs)(r.Zp,{style:{borderColor:"#e7e7e7",backgroundColor:"#ffffff"},children:[(0,l.jsxs)(r.aR,{children:[(0,l.jsx)(r.ZB,{style:{color:"#51247a"},children:"All Staff"}),(0,l.jsx)(r.BT,{children:"View and manage all staff members"})]}),(0,l.jsxs)(r.Wu,{children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4 mb-6",children:[(0,l.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,l.jsx)(u.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,l.jsx)(n.p,{placeholder:"Search by name, email, or office...",value:b,onChange:e=>B(e.target.value),className:"pl-10 focus:border-purple-500",style:{borderColor:"#e7e7e7"}})]}),(0,l.jsxs)(c.l6,{value:w,onValueChange:e=>{C(e),H(b,e)},children:[(0,l.jsx)(c.bq,{className:"w-48 focus:border-purple-500",style:{borderColor:"#e7e7e7"},children:(0,l.jsx)(c.yv,{})}),(0,l.jsx)(c.gC,{children:k.map(e=>(0,l.jsx)(c.eb,{value:e,children:e},e))})]})]}),(0,l.jsx)("div",{className:"rounded-md border",style:{borderColor:"#e7e7e7"},children:(0,l.jsxs)(d.XI,{children:[(0,l.jsx)(d.A0,{children:(0,l.jsxs)(d.Hj,{style:{backgroundColor:"#f8fafc"},children:[(0,l.jsx)(d.nd,{style:{color:"#51247a"},children:"No"}),(0,l.jsx)(d.nd,{style:{color:"#51247a"},children:"Staff Member"}),(0,l.jsx)(d.nd,{style:{color:"#51247a"},children:"Office"}),(0,l.jsx)(d.nd,{style:{color:"#51247a"},children:"Phone Number"}),(0,l.jsx)(d.nd,{style:{color:"#51247a"},children:"Actions"})]})}),(0,l.jsx)(d.BF,{children:A.map((e,s)=>(0,l.jsxs)(d.Hj,{className:"hover:bg-gray-50",children:[(0,l.jsx)(d.nA,{children:(0,l.jsx)("span",{className:"font-medium text-gray-900",children:s+1})}),(0,l.jsx)(d.nA,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})}),(0,l.jsx)(d.nA,{children:(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium text-gray-900",children:e.officeName}),"N/A"!==e.officeSection&&(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["Section: ",e.officeSection]})]})}),(0,l.jsx)(d.nA,{children:(0,l.jsx)("div",{children:e.phone&&""!==e.phone.trim()?(0,l.jsxs)("p",{className:"text-sm text-gray-900 flex items-center",children:[(0,l.jsx)(h.A,{className:"w-3 h-3 mr-1"}),e.phone]}):(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"N/A"})})}),(0,l.jsx)(d.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(i.$,{size:"sm",variant:"outline",className:"border-blue-200 text-blue-600 hover:bg-blue-50 bg-transparent",onClick:()=>U(e),children:(0,l.jsx)(p.A,{className:"w-3 h-3"})}),(0,l.jsx)(i.$,{size:"sm",variant:"outline",className:"border-red-200 text-red-600 hover:bg-red-50 bg-transparent",onClick:()=>R(e._id),disabled:T===e._id,children:T===e._id?(0,l.jsx)(f.A,{className:"w-3 h-3 animate-spin"}):(0,l.jsx)(N.A,{className:"w-3 h-3"})})]})})]},e._id))})]})}),0===A.length&&!a&&(0,l.jsx)("div",{className:"text-center py-8",children:(0,l.jsx)("p",{className:"text-gray-500",children:"No staff members found matching your search criteria."})})]})]}),(0,l.jsx)(o.lG,{open:L,onOpenChange:O,children:(0,l.jsxs)(o.Cf,{className:"max-w-md",children:[(0,l.jsxs)(o.c7,{children:[(0,l.jsx)(o.L3,{style:{color:"#51247a"},children:"Edit Staff Member"}),(0,l.jsx)(o.rr,{children:"Update the staff member's information"})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Name"}),(0,l.jsx)(n.p,{value:$.name,onChange:e=>W({...$,name:e.target.value}),placeholder:"Enter name",className:"mt-1"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Email"}),(0,l.jsx)(n.p,{value:$.email,onChange:e=>W({...$,email:e.target.value}),placeholder:"Enter email",className:"mt-1"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Phone"}),(0,l.jsx)(n.p,{value:$.phone,onChange:e=>W({...$,phone:e.target.value}),placeholder:"Enter phone number",className:"mt-1"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Designation"}),(0,l.jsx)(n.p,{value:$.designation,onChange:e=>W({...$,designation:e.target.value}),placeholder:"Enter designation",className:"mt-1"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Qualification"}),(0,l.jsx)(n.p,{value:$.qualification,onChange:e=>W({...$,qualification:e.target.value}),placeholder:"Enter qualification",className:"mt-1"})]})]}),(0,l.jsxs)(o.Es,{children:[(0,l.jsx)(i.$,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),(0,l.jsx)(i.$,{style:{backgroundColor:"#51247a"},className:"text-white",onClick:D,disabled:Z,children:Z?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):"Save Changes"})]})]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[3096,9924,7976,4973,5554,2396,2347,4870,7358],()=>s(20958)),_N_E=e.O()}]);