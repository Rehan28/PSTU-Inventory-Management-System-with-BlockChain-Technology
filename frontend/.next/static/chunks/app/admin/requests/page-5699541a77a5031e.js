(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[269],{15842:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(87982).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},20544:(e,t,s)=>{"use strict";s.d(t,{DX:()=>i});var r=s(1521),a=s(80937),l=s(73365),i=r.forwardRef((e,t)=>{let{children:s,...a}=e,i=r.Children.toArray(s),d=i.find(c);if(d){let e=d.props.children,s=i.map(t=>t!==d?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,l.jsx)(n,{...a,ref:t,children:r.isValidElement(e)?r.cloneElement(e,void 0,s):null})}return(0,l.jsx)(n,{...a,ref:t,children:s})});i.displayName="Slot";var n=r.forwardRef((e,t)=>{let{children:s,...l}=e;if(r.isValidElement(s)){let e=function(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,s=t&&"isReactWarning"in t&&t.isReactWarning;return s?e.ref:(s=(t=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in t&&t.isReactWarning)?e.props.ref:e.props.ref||e.ref}(s);return r.cloneElement(s,{...function(e,t){let s={...t};for(let r in t){let a=e[r],l=t[r];/^on[A-Z]/.test(r)?a&&l?s[r]=(...e)=>{l(...e),a(...e)}:a&&(s[r]=a):"style"===r?s[r]={...a,...l}:"className"===r&&(s[r]=[a,l].filter(Boolean).join(" "))}return{...e,...s}}(l,s.props),ref:t?(0,a.t)(t,e):e})}return r.Children.count(s)>1?r.Children.only(null):null});n.displayName="SlotClone";var d=({children:e})=>(0,l.jsx)(l.Fragment,{children:e});function c(e){return r.isValidElement(e)&&e.type===d}},39386:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>d,TN:()=>o,XL:()=>c});var r=s(73365),a=s(1521),l=s(82934),i=s(69671);let n=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=a.forwardRef((e,t)=>{let{className:s,variant:a,...l}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,i.cn)(n({variant:a}),s),...l})});d.displayName="Alert";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h5",{ref:t,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",s),...a})});c.displayName="AlertTitle";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",s),...a})});o.displayName="AlertDescription"},42552:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(87982).A)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},49703:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(87982).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},58600:(e,t,s)=>{"use strict";s.d(t,{$:()=>c});var r=s(73365),a=s(1521),l=s(20544),i=s(82934),n=s(69671);let d=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:c=!1,...o}=e,u=c?l.DX:"button";return(0,r.jsx)(u,{className:(0,n.cn)(d({variant:a,size:i,className:s})),ref:t,...o})});c.displayName="Button"},66009:(e,t,s)=>{"use strict";s.d(t,{E:()=>n});var r=s(73365);s(1521);var a=s(82934),l=s(69671);let i=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:(0,l.cn)(i({variant:s}),t),...a})}},67931:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(87982).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},69671:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var r=s(74584),a=s(22292);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}},72196:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(87982).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},80937:(e,t,s)=>{"use strict";s.d(t,{s:()=>i,t:()=>l});var r=s(1521);function a(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function l(...e){return t=>{let s=!1,r=e.map(e=>{let r=a(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){let s=r[t];"function"==typeof s?s():a(e[t],null)}}}}function i(...e){return r.useCallback(l(...e),e)}},82934:(e,t,s)=>{"use strict";s.d(t,{F:()=>i});var r=s(74584);let a=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,l=r.$,i=(e,t)=>s=>{var r;if((null==t?void 0:t.variants)==null)return l(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:i,defaultVariants:n}=t,d=Object.keys(i).map(e=>{let t=null==s?void 0:s[e],r=null==n?void 0:n[e];if(null===t)return null;let l=a(t)||a(r);return i[e][l]}),c=s&&Object.entries(s).reduce((e,t)=>{let[s,r]=t;return void 0===r||(e[s]=r),e},{});return l(e,d,null==t?void 0:null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:s,className:r,...a}=t;return Object.entries(a).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...n,...c}[t]):({...n,...c})[t]===s})?[...e,s,r]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}},84128:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var r=s(73365),a=s(1521),l=s(86170),i=s(66009),n=s(39386),d=s(49703),c=s(86414),o=s(15842),u=s(72196),m=s(42552),p=s(67931),x=s(58600);let f="localhost"===window.location.hostname?"http://localhost:5000":"";function h(e){return null==e?"":String(e)}function g(e){return e?"string"==typeof e?e:"object"==typeof e&&"_id"in e?e._id:String(e):""}async function v(e){try{let t=g(e);if(!t)return{name:e,email:"No email"};let s=await fetch("".concat(f,"/api/users/get/").concat(t));if(!s.ok)return{name:t,email:"No email"};let r=await s.json();console.log("[v0] fetchUserData result:",r);let a=r.name||r.fullName||t,l=r.email||"No email";return{name:a,email:l}}catch(t){return console.error("[v0] fetchUserData error:",t),{name:e,email:"No email"}}}async function b(e){try{let t=g(e);if(!t)return e;let s=await fetch("".concat(f,"/api/items/get/").concat(t));if(!s.ok)return t;let r=await s.json();return r.name||r.itemName||t}catch(t){return e}}async function y(e){try{let t=g(e);if(!t)return e;let s=await fetch("".concat(f,"/api/suppliers/get/").concat(t));if(!s.ok)return t;let r=await s.json();return r.name||r.supplierName||t}catch(t){return e}}function N(e){var t,s,r;let a=e.image_url||e.imageUrl||"",l="number"==typeof e.quantity?e.quantity:Number(e.quantity||0),i="number"==typeof e.unit_price?e.unit_price:Number(e.unit_price||0);"number"==typeof e.total_price?e.total_price:Number(e.total_price||l*i);let n=e.productName||e.itemName||"Item ".concat(e.item_id||"(unknown)"),d=(null===(t=e.requestedById)||void 0===t?void 0:t.name)||e.requestedByName||"Unknown User",c=(null===(s=e.requestedById)||void 0===s?void 0:s.email)||void 0,o=g(e.requestedByUserId||(null===(r=e.requestedById)||void 0===r?void 0:r._id)||e.user_id);return{...e,_id:h(e._id),productName:n,productSku:e.productSku||void 0,quantity:l,unitPrice:i,description:h(e.description),supplier:h(e.supplier||e.supplier_id),imageUrl:a,status:"approved"===e.status?"approved":"rejected"===e.status?"rejected":"pending",requestedByName:d,requestedByEmail:c,requestedByUserId:o,requestedAt:e.requested_at||e.createdAt||new Date().toISOString(),invoiceNo:e.invoice_no||e.invoiceNo||void 0}}function j(e){if(!e)return"/placeholder.svg";if(e.startsWith("http"))return e;let t=e.split("/").pop()||e;return"".concat(f,"/uploads/").concat(t)}async function w(e,t){var s,r;let a=g(e.requestedByUserId||(null===(s=e.requestedById)||void 0===s?void 0:s._id)||e.user_id);a||(a="system");let l=e.item_id||e.productSku||"ITEM-".concat(e._id),i=e.supplier||e.supplier_id||"N/A",n="number"==typeof e.quantity?e.quantity:Number(e.quantity||0),d="number"==typeof e.unitPrice?e.unitPrice:"number"==typeof e.unit_price?e.unit_price:Number(e.unit_price||0),c="number"==typeof e.total_price?e.total_price:Number(e.total_price||0);if((!d||d<=0)&&c>0&&n>0&&(d=c/n),!n||n<=0)throw Error("Quantity must be greater than 0");if(!d||d<=0)throw Error("Valid unit price is required");let o=null,u=null;if(e.requestedById){let t=e.requestedById;(t.department_id||t.department)&&(o=t.department_id||t.department),(t.office_id||t.office)&&(u=t.office_id||t.office),t.role&&t.role}if(a&&"system"!==a&&(!o||!u))try{let e=await fetch("".concat(f,"/api/users/get/").concat(a));if(e.ok){let t=await e.json(),s=t.data||t.user||t;console.log("[v0] User data received:",JSON.stringify(s,null,2)),s.role,o=s.department_id||s.department||null,u=s.office_id||s.office||null}}catch(e){console.error("[v0] Error fetching user info:",e)}if(!o&&!u)throw Error("Cannot create stock-in: requester has no department_id or office_id.\nUserId: ".concat(a));let m=e.invoiceNo||e.invoice_no||"".concat(l,"-").concat(Date.now()),p={user_id:a,item_id:l,supplier_id:i,quantity:n,unit_price:d,total_price:n*d,purchase_date:new Date(e.requestedAt).toISOString().split("T")[0],invoice_no:m,department_id:o||"ok",office_id:u||"ok",remarks:"Stock request approved\n"+"Requested by: ".concat(e.requestedByName||(null===(r=e.requestedById)||void 0===r?void 0:r.name)||"N/A","\n")+"Product: ".concat(e.productName,"\n")+"Description: ".concat(e.description)};console.log("createStockInEntry payload:",p);let x=await fetch("".concat(f,"/api/stockins/create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)});if(!x.ok){let e="Failed to create stock-in: ".concat(x.status);try{let t=await x.json();e=t.message||JSON.stringify(t)}catch(e){}throw Error(e)}let h=await x.json();return{invoiceNo:p.invoice_no,response:h}}function _(){let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)(null),[m,p]=(0,a.useState)({}),[x,h]=(0,a.useState)({}),[g,j]=(0,a.useState)({}),[_,A]=(0,a.useState)(!0),[S,R]=(0,a.useState)(null),[B,C]=(0,a.useState)(null),[I,E]=(0,a.useState)(null),[U,D]=(0,a.useState)(0),[F,P]=(0,a.useState)(!1),O=(0,a.useRef)(null),T=(0,a.useRef)({items:new Set,suppliers:new Set,users:new Set});async function V(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];try{e&&A(!0);let s=await fetch("".concat(f,"/api/stockInRequest/get"));if(!s.ok)throw Error("Failed to fetch: ".concat(s.status));let r=await s.json(),a=Array.isArray(r)?r.map(N):[];t(e=>{let t=e.filter(e=>"pending"===e.status).length,s=a.filter(e=>"pending"===e.status).length;return t>0&&s>t&&P(!0),D(s),a}),R(null)}catch(e){console.error("fetchRequests error",e),R(e instanceof Error?e.message:"Unknown error fetching requests")}finally{A(!1)}}(0,a.useEffect)(()=>(V().catch(e=>console.error(e)),O.current=window.setInterval(()=>{V(!1).catch(e=>console.error(e))},3e4),()=>{O.current&&window.clearInterval(O.current)}),[]),(0,a.useEffect)(()=>{0!==e.length&&(async()=>{console.log("[v0] Fetching names for requests:",e.length);let t={...m},s={...x},r={...g};for(let a of e){if(a.item_id&&!T.current.items.has(a.item_id)){T.current.items.add(a.item_id);let e=await b(a.item_id);console.log("[v0] Item fetched:",a.item_id,"->",e),t[a.item_id]=e}if(a.supplier&&!T.current.suppliers.has(a.supplier)){T.current.suppliers.add(a.supplier);let e=await y(a.supplier);console.log("[v0] Supplier fetched:",a.supplier,"->",e),s[a.supplier]=e}if(a.requestedByUserId&&!T.current.users.has(a.requestedByUserId)){T.current.users.add(a.requestedByUserId);let e=await v(a.requestedByUserId);console.log("[v0] User fetched:",a.requestedByUserId,"->",e),r[a.requestedByUserId]=e}}console.log("[v0] Setting state - itemNames:",t,"supplierNames:",s,"userData:",r),p(t),h(s),j(r)})()},[e]);let W=e.filter(e=>"pending"===e.status),Z=e.filter(e=>"approved"===e.status),M=e.filter(e=>"rejected"===e.status);async function z(e){C(e._id);try{let{invoiceNo:r}=await w(e),a=await fetch("".concat(f,"/api/stockInRequest/update/").concat(e._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"approved",reviewedByName:"Admin",adminNote:"Auto-approved with stock entry",invoiceNo:r})});if(!a.ok){let e="Failed to update request: ".concat(a.status);try{let t=await a.json();e=t.message||JSON.stringify(t)}catch(e){}throw Error(e)}let l=await a.json(),n=N(l);t(e=>e.map(e=>e._id===n._id?n:e)),(null==s?void 0:s._id)===n._id&&i(n),R(null)}catch(e){console.error("onApprove error",e),R(e instanceof Error?e.message:"Failed to approve request")}finally{C(null)}}async function J(e){E(e._id);try{let r=await fetch("".concat(f,"/api/stockInRequest/update/").concat(e._id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"rejected",reviewedByName:"Admin",adminNote:"Rejected by admin"})});if(!r.ok)throw Error("Failed to reject: ".concat(r.status));let a=await r.json(),l=N(a);t(e=>e.map(e=>e._id===l._id?l:e)),(null==s?void 0:s._id)===l._id&&i(l)}catch(e){console.error("onReject error",e),R(e instanceof Error?e.message:"Reject failed")}finally{E(null)}}return _?(0,r.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"h-12 w-12 border-4 border-slate-300 border-t-blue-600 rounded-full mx-auto mb-4 animate-spin"}),(0,r.jsx)("p",{className:"text-slate-600",children:"Loading stock requests..."})]})}):(0,r.jsxs)("main",{className:"min-h-screen bg-slate-50",children:[(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Stock Requests"}),(0,r.jsx)("p",{className:"text-slate-600",children:"Manage and review stock request submissions"})]}),S&&(0,r.jsxs)(n.Fc,{variant:"destructive",className:"mb-6",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),(0,r.jsx)(n.TN,{children:S})]}),(0,r.jsxs)("section",{className:"mb-12",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,r.jsx)(c.A,{className:"h-6 w-6 text-amber-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900",children:["Pending Requests ",(0,r.jsxs)("span",{className:"text-amber-600",children:["(",W.length,")"]})]}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"Awaiting admin review"})]})]}),0===W.length?(0,r.jsx)(l.Zp,{className:"border-dashed border-slate-300 bg-white",children:(0,r.jsxs)(l.Wu,{className:"py-12 text-center",children:[(0,r.jsx)(c.A,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-slate-600 font-medium",children:"No pending requests at this time"})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:W.map(e=>(0,r.jsx)(q,{request:e,userData:g,itemNames:m,supplierNames:x,onClick:()=>i(e)},e._id))})]}),(0,r.jsxs)("section",{className:"mb-12",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,r.jsx)(o.A,{className:"h-6 w-6 text-green-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900",children:["Approved Requests ",(0,r.jsxs)("span",{className:"text-green-600",children:["(",Z.length,")"]})]}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"Successfully approved and ready"})]})]}),0===Z.length?(0,r.jsx)(l.Zp,{className:"border-dashed border-slate-300 bg-white",children:(0,r.jsxs)(l.Wu,{className:"py-12 text-center",children:[(0,r.jsx)(o.A,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-slate-600 font-medium",children:"No approved requests yet"})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Z.map(e=>(0,r.jsx)(q,{request:e,userData:g,itemNames:m,supplierNames:x,onClick:()=>i(e)},e._id))})]}),(0,r.jsxs)("section",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,r.jsx)(u.A,{className:"h-6 w-6 text-red-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900",children:["Rejected Requests ",(0,r.jsxs)("span",{className:"text-red-600",children:["(",M.length,")"]})]}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"Declined requests"})]})]}),0===M.length?(0,r.jsx)(l.Zp,{className:"border-dashed border-slate-300 bg-white",children:(0,r.jsxs)(l.Wu,{className:"py-12 text-center",children:[(0,r.jsx)(u.A,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-slate-600 font-medium",children:"No rejected requests"})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(e=>(0,r.jsx)(q,{request:e,userData:g,itemNames:m,supplierNames:x,onClick:()=>i(e)},e._id))})]})]}),s&&(0,r.jsx)(k,{request:s,userData:g,itemNames:m,supplierNames:x,onClose:()=>i(null),onApprove:()=>{z(s)},onReject:()=>J(s),isApproving:B===s._id,isRejecting:I===s._id})]})}function k(e){var t,s;let{request:a,userData:l,itemNames:n,supplierNames:d,onClose:c,onApprove:o,onReject:u,isApproving:f,isRejecting:h}=e,g="pending"===a.status,v=a.requestedByUserId,b=v?l[v]:null,y=(null==b?void 0:b.name)||(null===(t=a.requestedById)||void 0===t?void 0:t.name)||a.requestedByName||"Unknown User",N=(null==b?void 0:b.email)||(null===(s=a.requestedById)||void 0===s?void 0:s.email)||a.requestedByEmail||"No email available",w=a.item_id?n[a.item_id]||a.item_id:"N/A",_=a.supplier?d[a.supplier]||a.supplier:"N/A";return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:c,children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-slate-200",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"sticky top-0 bg-slate-100 border-b border-slate-200 px-6 py-5 flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900 flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"h-6 w-6"})," ",w]}),(0,r.jsx)("button",{onClick:c,className:"text-slate-600 text-2xl font-bold",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsx)("div",{className:"h-72 bg-slate-100 rounded border border-slate-200 overflow-hidden flex items-center justify-center",children:(0,r.jsx)("img",{src:j(a.imageUrl)||"/placeholder.svg",alt:a.productName,className:"w-full h-full object-cover",onError:e=>e.currentTarget.style.display="none"})}),(0,r.jsx)("div",{className:"border-b border-slate-200 pb-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-3xl font-bold text-slate-900",children:a.productName}),(0,r.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"approved"===a.status&&a.invoiceNo?(0,r.jsxs)(r.Fragment,{children:["Invoice: ",a.invoiceNo]}):(0,r.jsx)(r.Fragment,{children:w})})]}),(0,r.jsx)(i.E,{className:"font-bold px-4 py-1 text-sm ".concat("approved"===a.status?"bg-green-500":"rejected"===a.status?"bg-red-500":"bg-amber-500"),children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]})}),(0,r.jsx)("div",{className:"bg-slate-50 p-5 rounded border border-slate-200",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"p-3 bg-slate-200 rounded flex-shrink-0",children:(0,r.jsx)(p.A,{className:"h-6 w-6 text-slate-700"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-xs font-bold text-slate-600 uppercase tracking-wide",children:"Requested By"}),(0,r.jsx)("p",{className:"text-lg font-bold text-slate-900 mt-1",children:y}),(0,r.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:N})]})]})}),(0,r.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:(0,r.jsx)("table",{className:"w-full",children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-slate-600 bg-slate-50 w-1/3",children:"Product Description"}),(0,r.jsx)("td",{className:"px-4 py-3 text-slate-900",children:a.description})]}),(0,r.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-slate-600 bg-slate-50",children:"Supplier"}),(0,r.jsx)("td",{className:"px-4 py-3 text-slate-900",children:_})]}),(0,r.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-slate-600 bg-slate-50",children:"Quantity"}),(0,r.jsxs)("td",{className:"px-4 py-3 text-slate-900 font-bold",children:[a.quantity," units"]})]}),(0,r.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-slate-600 bg-slate-50",children:"Unit Price"}),(0,r.jsxs)("td",{className:"px-4 py-3 text-slate-900",children:["৳ ",a.unitPrice.toFixed(2)]})]}),(0,r.jsxs)("tr",{className:"bg-green-50",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-bold text-green-700 bg-green-100",children:"Total Amount"}),(0,r.jsxs)("td",{className:"px-4 py-3 text-lg font-bold text-green-700",children:["৳ ",(a.quantity*a.unitPrice).toFixed(2)]})]})]})})}),(0,r.jsxs)("div",{className:"text-sm text-slate-600",children:[(0,r.jsx)("p",{className:"font-semibold",children:"Requested at:"}),(0,r.jsx)("p",{children:new Date(a.requestedAt).toLocaleString()})]}),g&&(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,r.jsx)(x.$,{onClick:()=>u&&u(),disabled:h,variant:"destructive",className:"flex-1",children:h?"Rejecting...":"Reject"}),(0,r.jsx)(x.$,{onClick:()=>o&&o(),disabled:f,className:"flex-1 bg-green-600 hover:bg-green-700",children:f?"Approving...":"Approve"})]})]})]})})}function q(e){var t,s;let{request:a,userData:n,itemNames:d,supplierNames:c,onClick:o}=e,u="approved"===a.status,m="rejected"===a.status,x=a.requestedByUserId,f=x?n[x]:null,h=(null==f?void 0:f.name)||(null===(t=a.requestedById)||void 0===t?void 0:t.name)||a.requestedByName||"Unknown",g=(null==f?void 0:f.email)||(null===(s=a.requestedById)||void 0===s?void 0:s.email)||a.requestedByEmail||"No email",v=a.item_id?d[a.item_id]||a.item_id:"N/A",b=a.supplier?c[a.supplier]||a.supplier:"N/A";return(0,r.jsxs)(l.Zp,{onClick:o,className:"overflow-hidden border border-slate-200 bg-white cursor-pointer",children:[(0,r.jsxs)("div",{className:"relative h-32 bg-slate-100 overflow-hidden flex items-center justify-center",children:[(0,r.jsx)("img",{src:j(a.imageUrl)||"/placeholder.svg",alt:a.productName,className:"w-full h-full object-cover",onError:e=>e.currentTarget.style.display="none"}),(0,r.jsx)("div",{className:"absolute top-2 right-2",children:(0,r.jsx)(i.E,{className:"font-semibold text-xs px-2 py-1 ".concat(u?"bg-green-500":m?"bg-red-500":"bg-amber-500"),children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})})]}),(0,r.jsxs)(l.aR,{className:"pb-2 border-b border-slate-100",children:[(0,r.jsx)(l.ZB,{className:"text-sm line-clamp-1 text-slate-900 font-bold",children:v}),(0,r.jsx)(l.BT,{className:"text-xs text-slate-500 line-clamp-1",children:a.productName})]}),(0,r.jsxs)(l.Wu,{className:"space-y-2 pt-3 pb-3",children:[(0,r.jsx)("div",{className:"bg-white p-2.5 rounded border border-slate-200",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"p-1.5 bg-slate-100 rounded-full flex-shrink-0",children:(0,r.jsx)(p.A,{className:"h-3 w-3 text-slate-600"})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-slate-900 line-clamp-1",children:h}),(0,r.jsx)("p",{className:"text-xs text-slate-500 line-clamp-1",children:g})]})]})}),(0,r.jsxs)("div",{className:"bg-slate-50 p-2 rounded border border-slate-200 space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,r.jsx)("span",{className:"text-slate-600 font-medium",children:"Qty:"}),(0,r.jsx)("span",{className:"font-bold text-slate-900",children:a.quantity})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs border-t border-slate-200 pt-1",children:[(0,r.jsx)("span",{className:"text-slate-600 font-bold",children:"Total:"}),(0,r.jsxs)("span",{className:"font-bold text-slate-900",children:["৳ ",(a.quantity*a.unitPrice).toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"text-xs",children:[(0,r.jsx)("p",{className:"text-slate-500 font-semibold mb-0.5",children:"Supplier"}),(0,r.jsx)("p",{className:"text-slate-900 font-medium line-clamp-1",children:b})]})]})]})}},86170:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>i,aR:()=>n});var r=s(73365),a=s(1521),l=s(69671);let i=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});i.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...a})});n.displayName="CardHeader";let d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...a})});d.displayName="CardTitle";let c=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...a})});c.displayName="CardDescription";let o=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...a})});o.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter"},86414:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(87982).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},98560:(e,t,s)=>{Promise.resolve().then(s.bind(s,84128))}},e=>{var t=t=>e(e.s=t);e.O(0,[3096,2347,4870,7358],()=>t(98560)),_N_E=e.O()}]);