(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8548],{24062:(e,t,a)=>{Promise.resolve().then(a.bind(a,59549))},58600:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var r=a(73365),n=a(1521),s=a(20544),l=a(82934),i=a(69671);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:a,variant:n,size:l,asChild:d=!1,...c}=e,p=d?s.DX:"button";return(0,r.jsx)(p,{className:(0,i.cn)(o({variant:n,size:l,className:a})),ref:t,...c})});d.displayName="Button"},59549:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var r=a(73365),n=a(1521),s=a(86170),l=a(58600),i=a(87812),o=a(63678),d=a(86414),c=a(2262),p=a(62041),x=a(20255),m=a.n(x);function g(){let[e,t]=(0,n.useState)(""),[a,x]=(0,n.useState)([]),[g,h]=(0,n.useState)([]),[u,f]=(0,n.useState)(!1),[y,b]=(0,n.useState)(null),[v,j]=(0,n.useState)(!1),[N,w]=(0,n.useState)(!1),[k,_]=(0,n.useState)(!1),[S,C]=(0,n.useState)("");(0,n.useEffect)(()=>{_(!0)},[]),(0,n.useEffect)(()=>{if(!k)return;let e=()=>{C(new Date().toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[k]),(0,n.useEffect)(()=>{k&&(async()=>{try{let e=await fetch("http://localhost:5000/api/users/get");if(e.ok){let t=await e.json();x(Array.isArray(t)?t:[])}}catch(e){console.error("[v0] Failed to fetch users:",e)}})()},[k]),(0,n.useEffect)(()=>{e.trim().length>0?(h(a.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()))),f(!0)):(h([]),f(!1))},[e,a]);let F=async e=>{j(!0),t(""),h([]),f(!1);try{let t=await fetch("http://localhost:5000/api/items/get");if(!t.ok)throw Error("Failed to fetch items");let a=await t.json(),r=await fetch("http://localhost:5000/api/stockins/user/".concat(e._id)),n=await fetch("http://localhost:5000/api/stockouts/user/".concat(e._id)),s=await fetch("http://localhost:5000/api/deadstocks/user/".concat(e._id)),l={},i={},o={};if(r.ok){let e=await r.json();l=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}if(n.ok){let e=await n.json();i=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}if(s.ok){let e=await s.json();o=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}let d=a.map(e=>{let t=l[e._id]||0,a=i[e._id]||0,r=o[e._id]||0;return{...e,stock_in:t,stock_out:a,dead_stock:r,current_stock:t-a}}).filter(e=>0!==e.stock_in||0!==e.stock_out||0!==e.dead_stock);b({...e,items:d})}catch(e){console.error("[v0] Failed to load user data:",e),alert("Failed to load user data. Please try again.")}finally{j(!1)}},A=async e=>{try{console.log("[v0] Attempting to load logo from:",e);let t=await fetch(e,{mode:"cors",credentials:"omit",headers:{Accept:"image/*"}});if(!t.ok)return console.warn("[v0] Failed to fetch image: ".concat(t.statusText)),"";let a=await t.blob();return new Promise(e=>{let t=new FileReader;t.onloadend=()=>{let a=t.result;e(a)},t.onerror=()=>{console.warn("[v0] FileReader error"),e("")},t.readAsDataURL(a)})}catch(e){return console.warn("[v0] Failed to load image:",e),""}},P=async()=>{if(y){w(!0);try{let e="";try{e=await A("/pstu_logo.jpeg")}catch(e){console.warn("[v0] Logo loading failed, continuing without logo")}let t=document.createElement("div");t.style.position="absolute",t.style.left="-9999px",t.style.width="900px",t.style.backgroundColor="white";let a=y.items.map((e,t)=>'\n        <tr>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center;">'.concat(t+1,'</td>\n          <td style="border:1px solid #ddd; padding:6px;">').concat(e.name||"N/A",'</td>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e8f5e9; font-weight:bold;">').concat(Number(e.stock_in)||0,'</td>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fce4ec; font-weight:bold;">').concat(Number(e.stock_out)||0,'</td>\n          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fff3e0; font-weight:bold;">').concat(Number(e.dead_stock)||0,"</td>\n        </tr>\n      ")).join("");t.innerHTML='\n        <div style="font-family: Arial, sans-serif; padding: 20px; background-color: white;">\n          \x3c!-- University Logo --\x3e\n          <div style="text-align:center; margin-bottom: 15px;">\n            '.concat(e?'<img src="'.concat(e,'" alt="PSTU Logo" style="width:90px; height:90px; border-radius:50%; margin:0 auto 10px; object-fit: cover; display:block; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" />'):'<div style="width:90px; height:90px; margin:0 auto 10px; background-color:#f0f0f0; border: 1px solid #ddd; display:flex; align-items:center; justify-content:center; font-size:10px; color:#999; border-radius:50%;">Logo</div>','\n          </div>\n\n          <div style="text-align:center; margin-bottom: 20px;">\n            <h2 style="color:#51247a; margin:5px 0; font-size: 18px;">পটুয়াখালী বিজ্ঞান ও প্রযুক্তি বিশ্ববিদ্যালয়</h2>\n            <h4 style="color:#666; margin:3px 0; font-size: 14px;">Patuakhali Science and Technology University</h4>\n            <h3 style="margin:10px 0; color:#51247a; font-size: 16px;">ব্যবহারকারী আইটেম রিপোর্ট</h3>\n            <hr style="border:1px solid #51247a; margin-top:10px;" />\n          </div>\n\n          <div style="margin-bottom: 20px; padding: 10px; background-color: #f5f5f5; border-radius: 5px;">\n            <p style="margin: 5px 0;"><strong>ব্যবহারকারীর নাম:</strong> ').concat(y.name,"</p>\n            ").concat(y.email?'<p style="margin: 5px 0;"><strong>ইমেইল:</strong> '.concat(y.email,"</p>"):"","\n            ").concat(y.phone?'<p style="margin: 5px 0;"><strong>ফোন:</strong> '.concat(y.phone,"</p>"):"",'\n            <p style="margin: 5px 0;"><strong>রিপোর্ট তারিখ:</strong> ').concat(new Date().toLocaleString("bn-BD"),'</p>\n          </div>\n\n          <table style="width:100%; border-collapse:collapse; font-size:10px;">\n            <thead>\n              <tr style="background-color:#51247a; color:white;">\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ক্রমিক<br/>(Number)</th>\n                <th style="border:1px solid #ddd; padding:6px;">পণ্যের নাম<br/>(Item Name)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক ইন<br/>(Stock IN)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক আউট<br/>(Stock OUT)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ডেড স্টক<br/>(Dead Stock)</th>\n              </tr>\n            </thead>\n            <tbody>\n              ').concat(a,'\n            </tbody>\n          </table>\n\n          <p style="text-align:center; margin-top:20px; font-size:10px;">\n            \xa9 ').concat(new Date().getFullYear()," Patuakhali Science and Technology University.\n          </p>\n        </div>\n      "),document.body.appendChild(t),await new Promise(e=>setTimeout(e,1200));let r=await m()(t,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff"}),n=r.toDataURL("image/png"),s=new p.Ay("p","mm","a4"),l=s.internal.pageSize.getWidth(),i=r.height*l/r.width;if(i>s.internal.pageSize.getHeight()){s.addImage(n,"PNG",0,0,l,i);let e=i-s.internal.pageSize.getHeight(),t=0;for(;e>0;)t=e-i,s.addPage(),s.addImage(n,"PNG",0,t,l,i),e-=s.internal.pageSize.getHeight()}else s.addImage(n,"PNG",0,0,l,i);s.save("user-report-".concat(y.name,"-").concat(new Date().toISOString().split("T")[0],".pdf")),document.body.removeChild(t)}catch(e){console.error("[v0] Failed to generate PDF:",e),alert("Failed to generate PDF. Please try again.")}finally{w(!1)}}};return k?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,r.jsx)("div",{className:"w-full max-w-2xl space-y-6",children:y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Zp,{children:(0,r.jsx)(s.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center gap-3 text-center justify-center",children:[(0,r.jsx)(d.A,{className:"w-5 h-5",style:{color:"#51247a"}}),(0,r.jsx)("div",{className:"text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-lg",children:S})]})})}),(0,r.jsx)(s.Zp,{children:(0,r.jsxs)(s.Wu,{className:"p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",style:{color:"#51247a"},children:y.name}),(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[y.email&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"ইমেইল:"})," ",y.email]}),y.phone&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"ফোন:"})," ",y.phone]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"font-medium",children:"মোট আইটেম:"})," ",y.items.length]})]})]})}),y.items.length>0?(0,r.jsx)(s.Zp,{children:(0,r.jsx)(s.Wu,{className:"p-6",children:(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full text-sm",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{style:{backgroundColor:"#51247a"},className:"text-white",children:[(0,r.jsx)("th",{className:"px-4 py-3 text-center",children:"ক্রমিক"}),(0,r.jsx)("th",{className:"px-4 py-3 text-left",children:"পণ্যের নাম"}),(0,r.jsx)("th",{className:"px-4 py-3 text-center",children:"স্টক ইন"}),(0,r.jsx)("th",{className:"px-4 py-3 text-center",children:"স্টক আউট"}),(0,r.jsx)("th",{className:"px-4 py-3 text-center",children:"ডেড স্টক"})]})}),(0,r.jsx)("tbody",{children:y.items.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-center",children:t+1}),(0,r.jsx)("td",{className:"px-4 py-3",children:e.name||"N/A"}),(0,r.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.stock_in)||0}),(0,r.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.stock_out)||0}),(0,r.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.dead_stock)||0})]},e._id))})]})})})}):(0,r.jsx)(s.Zp,{children:(0,r.jsx)(s.Wu,{className:"p-6 text-center text-gray-500",children:"এই ব্যবহারকারীর কোনো আইটেম নেই"})}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(l.$,{onClick:P,disabled:N,className:"flex-1 text-white gap-2",style:{backgroundColor:"#51247a"},children:N?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.A,{className:"w-4 h-4 animate-spin"}),"তৈরি হচ্ছে..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.A,{className:"w-4 h-4"}),"PDF ডাউনলোড করুন"]})}),(0,r.jsx)(l.$,{onClick:()=>{b(null),t("")},variant:"outline",children:"নতুন অনুসন্ধান"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-2",style:{color:"#51247a"},children:"ব্যবহারকারী রিপোর্ট"}),(0,r.jsx)("p",{className:"text-gray-600",children:"User Report - Search and generate reports by user"})]}),(0,r.jsx)(s.Zp,{children:(0,r.jsx)(s.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"relative space-y-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"ব্যবহারকারী খুঁজুন"}),(0,r.jsx)(i.p,{type:"text",placeholder:"ব্যবহারকারীর নাম লিখুন... (Search user name)",value:e,onChange:e=>t(e.target.value),onFocus:()=>e.trim().length>0&&f(!0),className:"w-full"}),u&&g.length>0&&(0,r.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-10 max-h-64 overflow-y-auto",children:g.map(e=>(0,r.jsxs)("button",{onClick:()=>F(e),className:"w-full text-left px-4 py-3 hover:bg-gray-50 border-b last:border-b-0 transition-colors",children:[(0,r.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),e.email&&(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.email})]},e._id))}),u&&0===g.length&&e.trim().length>0&&(0,r.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-10 p-4 text-center text-gray-500 text-sm",children:"কোনো ব্যবহারকারী পাওয়া যায়নি"})]})})})]})})}):(0,r.jsx)("div",{className:"min-h-[200px] flex items-center justify-center",children:(0,r.jsx)(o.A,{className:"w-6 h-6 animate-spin"})})}},69671:(e,t,a)=>{"use strict";a.d(t,{cn:()=>s});var r=a(74584),n=a(22292);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,r.$)(t))}},86170:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>l,aR:()=>i});var r=a(73365),n=a(1521),s=a(69671);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...n})});l.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",a),...n})});i.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",a),...n})});o.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",a),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",a),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",a),...n})}).displayName="CardFooter"},87812:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});var r=a(73365),n=a(1521),s=a(69671);let l=n.forwardRef((e,t)=>{let{className:a,type:n,...l}=e;return(0,r.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"}},e=>{var t=t=>e(e.s=t);e.O(0,[5501,8262,5484,3096,2498,2347,4870,7358],()=>t(24062)),_N_E=e.O()}]);