(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5695],{40447:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(87982).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},49527:(e,t,r)=>{Promise.resolve().then(r.bind(r,52561))},52561:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(73365),n=r(1521),o=r(86170),s=r(58600),i=r(63678),d=r(40447),l=r(86414),c=r(2262);let u=(0,r(87982).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var p=r(62041),x=r(20255),m=r.n(x);function h(){let[e,t]=(0,n.useState)([]),[r,x]=(0,n.useState)(""),[h,g]=(0,n.useState)(!1),[f,y]=(0,n.useState)(""),[b,v]=(0,n.useState)(!1),[k,w]=(0,n.useState)(!1);(0,n.useEffect)(()=>{v(!0)},[]),(0,n.useEffect)(()=>{if(!b)return;let e=()=>{x(new Date().toLocaleString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}))};e();let t=setInterval(e,1e3);return()=>clearInterval(t)},[b]);let N=async e=>{try{let t=await fetch("http://localhost:5000/api/stockins/item/".concat(e)),r=t.ok?await t.json():null,a=await fetch("http://localhost:5000/api/stockouts/item/".concat(e)),n=a.ok?await a.json():null,o=await fetch("http://localhost:5000/api/deadstocks/item/".concat(e)),s=o.ok?await o.json():null,i=j(r),d=j(n),l=j(s),c=Math.max(0,i-d-l);return{stock_in:i,stock_out:d,dead_stock:l,current_stock:c}}catch(t){return console.error("Error fetching stock stats for item ".concat(e,":"),t),{stock_in:0,stock_out:0,dead_stock:0,current_stock:0}}},j=e=>e?Array.isArray(e)?e.reduce((e,t)=>e+(Number(t.quantity)||0),0):e.quantity?Number(e.quantity)||0:e.data&&Array.isArray(e.data)?e.data.reduce((e,t)=>e+(Number(t.quantity)||0),0):0:0,_=e=>e.filter(e=>{let t=Number(e.stock_in)||0,r=Number(e.stock_out)||0,a=Number(e.dead_stock)||0;return 0!==t||0!==r||0!==a}),A=async e=>{let t=await fetch("http://localhost:5000/api/items/get",{signal:e});if(!t.ok)throw Error(await t.text());let r=await t.json();return _(await Promise.all(r.map(async t=>{if(null==e?void 0:e.aborted)return{...t,stock_in:0,stock_out:0,dead_stock:0,current_stock:0};let r=await N(t._id),a=Number(r.stock_in)||Number(t.stock_in)||0,n=Number(r.stock_out)||Number(t.stock_out)||0,o=Number(r.dead_stock)||Number(t.dead_stock)||0,s=Number(r.current_stock)||Math.max(0,a-n-o);return{...t,stock_in:a,stock_out:n,dead_stock:o,current_stock:s}})))},C=async e=>{try{let t=await fetch(e,{mode:"cors",credentials:"omit"});if(!t.ok)return"";let r=await t.blob();return new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(r)})}catch(e){return""}},S=async()=>{try{g(!0);let t=e.length>0?e:await A();t=_(t);let r=await C("/pstu_logo.jpeg"),a=document.createElement("div");a.style.position="absolute",a.style.left="-9999px",a.style.width="900px",a.innerHTML='\n        <div style="font-family: Arial, sans-serif; padding: 20px; background-color: white;">\n          \x3c!-- Logo in round shape --\x3e\n          <div style="text-align:center; margin-bottom: 15px;">\n            '.concat(r?'<img src="'.concat(r,'" alt="PSTU Logo" style="width:90px; height:90px; border-radius:50%; object-fit:cover; display:block; margin:0 auto 10px;" />'):"",'\n          </div>\n\n          <div style="text-align:center; margin-bottom: 20px;">\n            <h2 style="color:#51247a; margin:5px 0; font-size: 18px;">পটুয়াখালী বিজ্ঞান ও প্রযুক্তি বিশ্ববিদ্যালয়</h2>\n            <h4 style="color:#666; margin:3px 0; font-size: 14px;">Patuakhali Science and Technology University</h4>\n            <h3 style="margin:10px 0; color:#51247a; font-size: 16px;">ইনভেন্টরি মোট রিপোর্ট (Total Inventory Report)</h3>\n            <hr style="border:1px solid #51247a; margin-top:10px;" />\n          </div>\n\n          <div style="font-size:12px; margin-bottom:15px;">\n            <strong>রিপোর্ট তারিখ:</strong> ').concat(new Date().toLocaleString("bn-BD"),'\n          </div>\n\n          <table style="width:100%; border-collapse:collapse; font-size:10px;">\n            <thead>\n              <tr style="background-color:#51247a; color:white;">\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ক্রমিক<br/>(Number)</th>\n                <th style="border:1px solid #ddd; padding:6px;">আইটেম<br/>(Item)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক ইন<br/>(Stock IN)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক আউট<br/>(Stock OUT)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ডেড স্টক<br/>(Dead Stock)</th>\n                <th style="border:1px solid #ddd; padding:6px; text-align:center;">বর্তমান স্টক<br/>(Current Stock)</th>\n              </tr>\n            </thead>\n            <tbody>\n              ').concat(t.map((e,t)=>{var r;let a=Number(e.stock_in)||0,n=Number(e.stock_out)||0,o=Number(e.dead_stock)||0,s=Number(e.current_stock)||Math.max(0,a-n-o);return'\n                    <tr>\n                      <td style="border:1px solid #ddd; padding:6px; text-align:center;">'.concat(t+1,'</td>\n                      <td style="border:1px solid #ddd; padding:6px;">').concat(null!==(r=e.name)&&void 0!==r?r:"",'</td>\n                      <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e8f5e9; font-weight:bold;">').concat(a,'</td>\n                      <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fce4ec; font-weight:bold;">').concat(n,'</td>\n                      <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fff3e0; font-weight:bold;">').concat(o,'</td>\n                      <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e3f2fd; font-weight:bold;">').concat(s,"</td>\n                    </tr>\n                  ")}).join(""),'\n            </tbody>\n          </table>\n\n          <p style="text-align:center; margin-top:20px; font-size:10px;">\n            এই রিপোর্টটি ইনভেন্টরি ম্যানেজমেন্ট সিস্টেম দ্বারা স্বয়ংক্রিয়ভাবে তৈরি করা হয়েছে।<br/>\n            \xa9 ').concat(new Date().getFullYear()," Patuakhali Science and Technology University.\n          </p>\n        </div>\n      "),document.body.appendChild(a),await new Promise(e=>setTimeout(e,1200));let n=await m()(a,{scale:2,useCORS:!0,allowTaint:!0,logging:!0,backgroundColor:"#ffffff"}),o=n.toDataURL("image/png"),s=new p.Ay("p","mm","a4"),i=s.internal.pageSize.getWidth(),d=n.height*i/n.width;s.addImage(o,"PNG",0,0,i,d),s.save("inventory-total-report-".concat(new Date().toISOString().split("T")[0],".pdf")),document.body.removeChild(a),g(!1)}catch(e){console.error("Error generating PDF:",e),alert("PDF generation failed. Please try again."),g(!1)}};return((0,n.useEffect)(()=>{if(!b)return;let e=new AbortController;return(async()=>{try{g(!0);let r=await A(e.signal);t(r),w(!0)}catch(e){y("Failed to load inventory data. Please check the API server.")}finally{g(!1)}})(),()=>e.abort()},[b]),b)?h&&!k?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.A,{className:"w-8 h-8 animate-spin mx-auto mb-3",style:{color:"#51247a"}}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading inventory report..."})]})}):f&&!k?(0,a.jsxs)("div",{className:"p-6 text-center text-red-600",children:[(0,a.jsx)(d.A,{className:"w-8 h-8 mx-auto mb-2"}),(0,a.jsx)("p",{children:f}),(0,a.jsx)(s.$,{onClick:()=>window.location.reload(),className:"mt-3",variant:"outline",children:"Retry"})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,a.jsx)(o.Zp,{className:"w-full max-w-md",children:(0,a.jsxs)(o.Wu,{className:"p-8 text-center space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-center items-center space-x-2 mb-2",children:[(0,a.jsx)(l.A,{className:"w-5 h-5",style:{color:"#51247a"}}),(0,a.jsx)("h2",{className:"text-lg font-semibold",style:{color:"#51247a"},children:"বর্তমান সময় (Current Time)"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:r})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold",style:{color:"#51247a"},children:"ইনভেন্টরি মোট রিপোর্ট"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Inventory Report Generator (PDF)"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Items loaded: ",e.length]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(s.$,{onClick:S,disabled:h||0===e.length,className:"w-full text-white flex justify-center space-x-2",style:{backgroundColor:"#51247a"},children:[h?(0,a.jsx)(i.A,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(c.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:h?"তৈরি হচ্ছে...":"PDF রিপোর্ট তৈরি করুন (Generate PDF)"})]}),(0,a.jsxs)(s.$,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full flex justify-center space-x-2",style:{borderColor:"#e7e7e7",color:"#51247a"},children:[(0,a.jsx)(u,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Refresh Data"})]})]})]})})}):(0,a.jsx)("div",{className:"min-h-[200px] flex items-center justify-center",children:(0,a.jsx)(i.A,{className:"w-6 h-6 animate-spin"})})}},58600:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var a=r(73365),n=r(1521),o=r(20544),s=r(82934),i=r(69671);let d=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:r,variant:n,size:s,asChild:l=!1,...c}=e,u=l?o.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(d({variant:n,size:s,className:r})),ref:t,...c})});l.displayName="Button"},69671:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var a=r(74584),n=r(22292);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,a.$)(t))}},86170:(e,t,r)=>{"use strict";r.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>d,Zp:()=>s,aR:()=>i});var a=r(73365),n=r(1521),o=r(69671);let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});s.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...n})});i.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});d.displayName="CardTitle";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...n})});l.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter"}},e=>{var t=t=>e(e.s=t);e.O(0,[5501,8262,5484,3096,2498,2347,4870,7358],()=>t(49527)),_N_E=e.O()}]);