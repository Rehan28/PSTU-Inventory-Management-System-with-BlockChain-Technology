(()=>{var e={};e.id=6291,e.ids=[6291],e.modules={1332:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var a=r(28625),s=r(64996),i=r(36761);let n=s.forwardRef(({className:e,type:t,...r},s)=>(0,a.jsx)("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...r}));n.displayName="Input"},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},71192:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(20413).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\pstu_inventory_management\\\\frontend\\\\app\\\\admin\\\\reports\\\\office\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\pstu_inventory_management\\frontend\\app\\admin\\reports\\office\\page.tsx","default")},73566:e=>{"use strict";e.exports=require("worker_threads")},75383:(e,t,r)=>{Promise.resolve().then(r.bind(r,71192))},79551:e=>{"use strict";e.exports=require("url")},83562:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var a=r(28625),s=r(64996),i=r(55136),n=r(55918),o=r(1332),d=r(33272),l=r(400),c=r(79344),p=r(67759),x=r(2650);function m(){let[e,t]=(0,s.useState)(""),[r,m]=(0,s.useState)([]),[h,u]=(0,s.useState)([]),[g,f]=(0,s.useState)(!1),[b,y]=(0,s.useState)(null),[j,v]=(0,s.useState)(!1),[w,N]=(0,s.useState)(!1),[_,k]=(0,s.useState)(!1),[P,S]=(0,s.useState)(""),$=e=>e.filter(e=>0!==e.stock_in||0!==e.stock_out||0!==e.dead_stock),A=async e=>{v(!0),t(""),u([]),f(!1);try{let t=await fetch("http://localhost:5000/api/items/get");if(!t.ok)throw Error("Failed to fetch items");let r=await t.json(),a=await fetch(`http://localhost:5000/api/stockins/office/${e._id}`),s=await fetch(`http://localhost:5000/api/stockouts/office/${e._id}`),i=await fetch(`http://localhost:5000/api/deadstocks/office/${e._id}`),n={},o={},d={};if(a.ok){let e=await a.json();n=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}if(s.ok){let e=await s.json();o=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}if(i.ok){let e=await i.json();d=Array.isArray(e)?e.reduce((e,t)=>(e[t.item_id]=(e[t.item_id]||0)+(t.quantity||0),e),{}):{}}let l=r.map(e=>{let t=n[e._id]||0,r=o[e._id]||0,a=d[e._id]||0;return{...e,stock_in:t,stock_out:r,dead_stock:a,current_stock:t-r}}),c=$(l);y({...e,items:c})}catch(e){console.error("[v0] Failed to load office data:",e),alert("Failed to load office data. Please try again.")}finally{v(!1)}},C=async e=>{try{let t=await fetch(e,{mode:"cors",credentials:"omit",headers:{Accept:"image/*"}});if(!t.ok)return"";let r=await t.blob();return new Promise(e=>{let t=new FileReader;t.onloadend=()=>{let r=t.result;e(r)},t.onerror=()=>{e("")},t.readAsDataURL(r)})}catch(e){return""}},D=async()=>{if(b){N(!0);try{let e="";try{e=await C("/pstu_logo.jpeg")}catch(e){console.warn("[v0] Logo loading failed, continuing without logo")}let t=document.createElement("div");t.style.position="absolute",t.style.left="-9999px",t.style.width="900px",t.style.backgroundColor="white";let r=$(b.items).map((e,t)=>`
        <tr>
          <td style="border:1px solid #ddd; padding:6px; text-align:center;">${t+1}</td>
          <td style="border:1px solid #ddd; padding:6px;">${e.name||"N/A"}</td>
          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e8f5e9; font-weight:bold;">${Number(e.stock_in)||0}</td>
          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fce4ec; font-weight:bold;">${Number(e.stock_out)||0}</td>
          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fff3e0; font-weight:bold;">${Number(e.dead_stock)||0}</td>
          <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e3f2fd; font-weight:bold;">${Number(e.current_stock)||0}</td>
        </tr>
      `).join("");t.innerHTML=`
        <div style="font-family: Arial, sans-serif; padding: 20px; background-color: white;">
          <div style="text-align:center; margin-bottom: 15px;">
            ${e?`<img src="${e}" alt="PSTU Logo" style="width:90px; height:90px; border-radius:50%; margin:0 auto 10px; object-fit: cover; display:block; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" />`:'<div style="width:90px; height:90px; margin:0 auto 10px; background-color:#f0f0f0; border: 1px solid #ddd; display:flex; align-items:center; justify-content:center; font-size:10px; color:#999; border-radius:50%;">Logo</div>'}
          </div>

          <div style="text-align:center; margin-bottom: 20px;">
            <h2 style="color:#51247a; margin:5px 0; font-size: 18px;">পটুয়াখালী বিজ্ঞান ও প্রযুক্তি বিশ্ববিদ্যালয়</h2>
            <h4 style="color:#666; margin:3px 0; font-size: 14px;">Patuakhali Science and Technology University</h4>
            <h3 style="margin:10px 0; color:#51247a; font-size: 16px;">অফিস আইটেম রিপোর্ট</h3>
            <hr style="border:1px solid #51247a; margin-top:10px;" />
          </div>

          <div style="margin-bottom: 20px; padding: 10px; background-color: #f5f5f5; border-radius: 5px;">
            <p style="margin: 5px 0;"><strong>অফিসের নাম:</strong> ${b.name}</p>
            ${b.description?`<p style="margin: 5px 0;"><strong>বর্ণনা:</strong> ${b.description}</p>`:""}
            ${b.location?`<p style="margin: 5px 0;"><strong>অবস্থান:</strong> ${b.location}</p>`:""}
            <p style="margin: 5px 0;"><strong>রিপোর্ট তারিখ:</strong> ${new Date().toLocaleString("bn-BD")}</p>
          </div>

          <table style="width:100%; border-collapse:collapse; font-size:10px;">
            <thead>
              <tr style="background-color:#51247a; color:white;">
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ক্রমিক<br/>(Number)</th>
                <th style="border:1px solid #ddd; padding:6px;">পণ্যের নাম<br/>(Item Name)</th>
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক ইন<br/>(Stock IN)</th>
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক আউট<br/>(Stock OUT)</th>
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ডেড স্টক<br/>(Dead Stock)</th>
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">বর্তমান স্টক<br/>(Current Stock)</th>
              </tr>
            </thead>
            <tbody>
              ${r}
            </tbody>
          </table>

          <p style="text-align:center; margin-top:20px; font-size:10px;">
            \xa9 ${new Date().getFullYear()} Patuakhali Science and Technology University.
          </p>
        </div>
      `,document.body.appendChild(t),await new Promise(e=>setTimeout(e,1200));let a=await (0,x.default)(t,{scale:2,useCORS:!0,allowTaint:!0,logging:!1,backgroundColor:"#ffffff"}),s=a.toDataURL("image/png"),i=new p.Ay("p","mm","a4"),n=i.internal.pageSize.getWidth(),o=a.height*n/a.width;if(o>i.internal.pageSize.getHeight()){i.addImage(s,"PNG",0,0,n,o);let e=o-i.internal.pageSize.getHeight(),t=0;for(;e>0;)t=e-o,i.addPage(),i.addImage(s,"PNG",0,t,n,o),e-=i.internal.pageSize.getHeight()}else i.addImage(s,"PNG",0,0,n,o);i.save(`office-report-${b.name}-${new Date().toISOString().split("T")[0]}.pdf`),document.body.removeChild(t)}catch(e){console.error("[v0] Failed to generate PDF:",e),alert("Failed to generate PDF. Please try again.")}finally{N(!1)}}};return _?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,a.jsx)("div",{className:"w-full max-w-2xl space-y-6",children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Zp,{children:(0,a.jsx)(i.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-3 text-center justify-center",children:[(0,a.jsx)(l.A,{className:"w-5 h-5",style:{color:"#51247a"}}),(0,a.jsx)("div",{className:"text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-lg",children:P})]})})}),(0,a.jsx)(i.Zp,{children:(0,a.jsxs)(i.Wu,{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",style:{color:"#51247a"},children:b.name}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[b.description&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"বর্ণনা:"})," ",b.description]}),b.location&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"অবস্থান:"})," ",b.location]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"মোট আইটেম:"})," ",b.items.length]})]})]})}),b.items.length>0?(0,a.jsx)(i.Zp,{children:(0,a.jsx)(i.Wu,{className:"p-6",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{style:{backgroundColor:"#51247a"},className:"text-white",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"ক্রমিক"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left",children:"পণ্যের নাম"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"স্টক ইন"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"স্টক আউট"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"ডেড স্টক"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center",children:"বর্তমান স্টক"})]})}),(0,a.jsx)("tbody",{children:b.items.map((e,t)=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:t+1}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.name||"N/A"}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.stock_in)||0}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.stock_out)||0}),(0,a.jsx)("td",{className:"px-4 py-3 text-center",children:Number(e.dead_stock)||0}),(0,a.jsx)("td",{className:"px-4 py-3 text-center font-medium",children:Number(e.current_stock)||0})]},e._id))})]})})})}):(0,a.jsx)(i.Zp,{children:(0,a.jsx)(i.Wu,{className:"p-6 text-center text-gray-500",children:"এই অফিসের কোনো আইটেম নেই"})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)(n.$,{onClick:D,disabled:w,className:"flex-1 text-white gap-2",style:{backgroundColor:"#51247a"},children:w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{className:"w-4 h-4 animate-spin"}),"তৈরি হচ্ছে..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{className:"w-4 h-4"}),"PDF ডাউনলোড করুন"]})}),(0,a.jsx)(n.$,{onClick:()=>{y(null),t("")},variant:"outline",children:"নতুন অনুসন্ধান"})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",style:{color:"#51247a"},children:"অফিস রিপোর্ট"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Office Report - Search and generate reports by office"})]}),(0,a.jsx)(i.Zp,{children:(0,a.jsx)(i.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"relative space-y-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"অফিস খুঁজুন"}),(0,a.jsx)(o.p,{type:"text",placeholder:"অফিসের নাম লিখুন... (Search office name)",value:e,onChange:e=>t(e.target.value),onFocus:()=>e.trim().length>0&&f(!0),className:"w-full"}),g&&h.length>0&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-10 max-h-64 overflow-y-auto",children:h.map(e=>(0,a.jsxs)("button",{onClick:()=>A(e),className:"w-full text-left px-4 py-3 hover:bg-gray-50 border-b last:border-b-0 transition-colors",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]},e._id))}),g&&0===h.length&&e.trim().length>0&&(0,a.jsx)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 rounded-lg shadow-lg z-10 p-4 text-center text-gray-500 text-sm",children:"কোনো অফিস পাওয়া যায়নি"})]})})})]})})}):(0,a.jsx)("div",{className:"min-h-[200px] flex items-center justify-center",children:(0,a.jsx)(d.A,{className:"w-6 h-6 animate-spin"})})}},87055:(e,t,r)=>{Promise.resolve().then(r.bind(r,83562))},98068:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>x,tree:()=>l});var a=r(5853),s=r(60554),i=r(30708),n=r.n(i),o=r(8067),d={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);r.d(t,d);let l={children:["",{children:["admin",{children:["reports",{children:["office",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,71192)),"D:\\pstu_inventory_management\\frontend\\app\\admin\\reports\\office\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,87254)),"D:\\pstu_inventory_management\\frontend\\app\\admin\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,31077))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,97898)),"D:\\pstu_inventory_management\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,92192,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,82137,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,48358,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,31077))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["D:\\pstu_inventory_management\\frontend\\app\\admin\\reports\\office\\page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},x=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/admin/reports/office/page",pathname:"/admin/reports/office",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9683,9139,4405,9692,8443],()=>r(98068));module.exports=a})();