(()=>{var e={};e.id=5695,e.ids=[5695],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12425:(e,t,r)=>{Promise.resolve().then(r.bind(r,74943))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22153:(e,t,r)=>{Promise.resolve().then(r.bind(r,59900))},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29395:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(33922).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},33873:e=>{"use strict";e.exports=require("path")},37346:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>l});var a=r(5853),n=r(60554),s=r(30708),o=r.n(s),i=r(8067),d={};for(let e in i)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);r.d(t,d);let l={children:["",{children:["admin",{children:["reports",{children:["current-stock",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,59900)),"D:\\pstu_inventory_management\\frontend\\app\\admin\\reports\\current-stock\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,87254)),"D:\\pstu_inventory_management\\frontend\\app\\admin\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,31077))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,97898)),"D:\\pstu_inventory_management\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,92192,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,82137,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,48358,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,31077))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["D:\\pstu_inventory_management\\frontend\\app\\admin\\reports\\current-stock\\page.tsx"],p={require:r,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:n.RouteKind.APP_PAGE,page:"/admin/reports/current-stock/page",pathname:"/admin/reports/current-stock",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},59900:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(20413).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\pstu_inventory_management\\\\frontend\\\\app\\\\admin\\\\reports\\\\current-stock\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\pstu_inventory_management\\frontend\\app\\admin\\reports\\current-stock\\page.tsx","default")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73566:e=>{"use strict";e.exports=require("worker_threads")},74943:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(28625),n=r(64996),s=r(55136),o=r(55918),i=r(33272),d=r(29395),l=r(400),c=r(79344);let p=(0,r(33922).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var u=r(67759),m=r(2650);function x(){let[e,t]=(0,n.useState)([]),[r,x]=(0,n.useState)(""),[h,g]=(0,n.useState)(!1),[y,b]=(0,n.useState)(""),[f,k]=(0,n.useState)(!1),[v,w]=(0,n.useState)(!1),_=async e=>{try{let t=await fetch(`http://localhost:5000/api/stockins/item/${e}`),r=t.ok?await t.json():null,a=await fetch(`http://localhost:5000/api/stockouts/item/${e}`),n=a.ok?await a.json():null,s=await fetch(`http://localhost:5000/api/deadstocks/item/${e}`),o=s.ok?await s.json():null,i=j(r),d=j(n),l=j(o),c=Math.max(0,i-d-l);return{stock_in:i,stock_out:d,dead_stock:l,current_stock:c}}catch(t){return console.error(`Error fetching stock stats for item ${e}:`,t),{stock_in:0,stock_out:0,dead_stock:0,current_stock:0}}},j=e=>e?Array.isArray(e)?e.reduce((e,t)=>e+(Number(t.quantity)||0),0):e.quantity?Number(e.quantity)||0:e.data&&Array.isArray(e.data)?e.data.reduce((e,t)=>e+(Number(t.quantity)||0),0):0:0,N=e=>e.filter(e=>{let t=Number(e.stock_in)||0,r=Number(e.stock_out)||0,a=Number(e.dead_stock)||0;return 0!==t||0!==r||0!==a}),P=async e=>{let t=await fetch("http://localhost:5000/api/items/get",{signal:e});if(!t.ok)throw Error(await t.text());let r=await t.json();return N(await Promise.all(r.map(async t=>{if(e?.aborted)return{...t,stock_in:0,stock_out:0,dead_stock:0,current_stock:0};let r=await _(t._id),a=Number(r.stock_in)||Number(t.stock_in)||0,n=Number(r.stock_out)||Number(t.stock_out)||0,s=Number(r.dead_stock)||Number(t.dead_stock)||0,o=Number(r.current_stock)||Math.max(0,a-n-s);return{...t,stock_in:a,stock_out:n,dead_stock:s,current_stock:o}})))},A=async e=>{try{let t=await fetch(e,{mode:"cors",credentials:"omit"});if(!t.ok)return"";let r=await t.blob();return new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(r)})}catch{return""}},D=async()=>{try{g(!0);let t=e.length>0?e:await P();t=N(t);let r=await A("/pstu_logo.jpeg"),a=document.createElement("div");a.style.position="absolute",a.style.left="-9999px",a.style.width="900px",a.innerHTML=`
        <div style="font-family: Arial, sans-serif; padding: 20px; background-color: white;">
          <!-- Logo in round shape -->
          <div style="text-align:center; margin-bottom: 15px;">
            ${r?`<img src="${r}" alt="PSTU Logo" style="width:90px; height:90px; border-radius:50%; object-fit:cover; display:block; margin:0 auto 10px;" />`:""}
          </div>

          <div style="text-align:center; margin-bottom: 20px;">
            <h2 style="color:#51247a; margin:5px 0; font-size: 18px;">পটুয়াখালী বিজ্ঞান ও প্রযুক্তি বিশ্ববিদ্যালয়</h2>
            <h4 style="color:#666; margin:3px 0; font-size: 14px;">Patuakhali Science and Technology University</h4>
            <h3 style="margin:10px 0; color:#51247a; font-size: 16px;">ইনভেন্টরি মোট রিপোর্ট (Total Inventory Report)</h3>
            <hr style="border:1px solid #51247a; margin-top:10px;" />
          </div>

          <div style="font-size:12px; margin-bottom:15px;">
            <strong>রিপোর্ট তারিখ:</strong> ${new Date().toLocaleString("bn-BD")}
          </div>

          <table style="width:100%; border-collapse:collapse; font-size:10px;">
            <thead>
              <tr style="background-color:#51247a; color:white;">
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ক্রমিক<br/>(Number)</th>
                <th style="border:1px solid #ddd; padding:6px;">আইটেম<br/>(Item)</th>
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক ইন<br/>(Stock IN)</th>
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">স্টক আউট<br/>(Stock OUT)</th>
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">ডেড স্টক<br/>(Dead Stock)</th>
                <th style="border:1px solid #ddd; padding:6px; text-align:center;">বর্তমান স্টক<br/>(Current Stock)</th>
              </tr>
            </thead>
            <tbody>
              ${t.map((e,t)=>{let r=Number(e.stock_in)||0,a=Number(e.stock_out)||0,n=Number(e.dead_stock)||0,s=Number(e.current_stock)||Math.max(0,r-a-n);return`
                    <tr>
                      <td style="border:1px solid #ddd; padding:6px; text-align:center;">${t+1}</td>
                      <td style="border:1px solid #ddd; padding:6px;">${e.name??""}</td>
                      <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e8f5e9; font-weight:bold;">${r}</td>
                      <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fce4ec; font-weight:bold;">${a}</td>
                      <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#fff3e0; font-weight:bold;">${n}</td>
                      <td style="border:1px solid #ddd; padding:6px; text-align:center; background-color:#e3f2fd; font-weight:bold;">${s}</td>
                    </tr>
                  `}).join("")}
            </tbody>
          </table>

          <p style="text-align:center; margin-top:20px; font-size:10px;">
            এই রিপোর্টটি ইনভেন্টরি ম্যানেজমেন্ট সিস্টেম দ্বারা স্বয়ংক্রিয়ভাবে তৈরি করা হয়েছে।<br/>
            \xa9 ${new Date().getFullYear()} Patuakhali Science and Technology University.
          </p>
        </div>
      `,document.body.appendChild(a),await new Promise(e=>setTimeout(e,1200));let n=await (0,m.default)(a,{scale:2,useCORS:!0,allowTaint:!0,logging:!0,backgroundColor:"#ffffff"}),s=n.toDataURL("image/png"),o=new u.Ay("p","mm","a4"),i=o.internal.pageSize.getWidth(),d=n.height*i/n.width;o.addImage(s,"PNG",0,0,i,d),o.save(`inventory-total-report-${new Date().toISOString().split("T")[0]}.pdf`),document.body.removeChild(a),g(!1)}catch(e){console.error("Error generating PDF:",e),alert("PDF generation failed. Please try again."),g(!1)}};return f?h&&!v?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(i.A,{className:"w-8 h-8 animate-spin mx-auto mb-3",style:{color:"#51247a"}}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading inventory report..."})]})}):y&&!v?(0,a.jsxs)("div",{className:"p-6 text-center text-red-600",children:[(0,a.jsx)(d.A,{className:"w-8 h-8 mx-auto mb-2"}),(0,a.jsx)("p",{children:y}),(0,a.jsx)(o.$,{onClick:()=>window.location.reload(),className:"mt-3",variant:"outline",children:"Retry"})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,a.jsx)(s.Zp,{className:"w-full max-w-md",children:(0,a.jsxs)(s.Wu,{className:"p-8 text-center space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-center items-center space-x-2 mb-2",children:[(0,a.jsx)(l.A,{className:"w-5 h-5",style:{color:"#51247a"}}),(0,a.jsx)("h2",{className:"text-lg font-semibold",style:{color:"#51247a"},children:"বর্তমান সময় (Current Time)"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600 bg-gray-50 p-3 rounded-lg",children:r})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-bold",style:{color:"#51247a"},children:"ইনভেন্টরি মোট রিপোর্ট"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Total Inventory Report Generator (PDF)"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["Items loaded: ",e.length]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(o.$,{onClick:D,disabled:h||0===e.length,className:"w-full text-white flex justify-center space-x-2",style:{backgroundColor:"#51247a"},children:[h?(0,a.jsx)(i.A,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(c.A,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:h?"তৈরি হচ্ছে...":"PDF রিপোর্ট তৈরি করুন (Generate PDF)"})]}),(0,a.jsxs)(o.$,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full flex justify-center space-x-2",style:{borderColor:"#e7e7e7",color:"#51247a"},children:[(0,a.jsx)(p,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Refresh Data"})]})]})]})})}):(0,a.jsx)("div",{className:"min-h-[200px] flex items-center justify-center",children:(0,a.jsx)(i.A,{className:"w-6 h-6 animate-spin"})})}},79551:e=>{"use strict";e.exports=require("url")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9683,9139,4405,9692,8443],()=>r(37346));module.exports=a})();