(()=>{var e={};e.id=269,e.ids=[269],e.modules={400:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},888:(e,t,s)=>{Promise.resolve().then(s.bind(s,98192))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5106:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>n,TN:()=>o,XL:()=>c});var r=s(28625),a=s(64996),i=s(44714),l=s(36761);let d=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),n=a.forwardRef(({className:e,variant:t,...s},a)=>(0,r.jsx)("div",{ref:a,role:"alert",className:(0,l.cn)(d({variant:t}),e),...s}));n.displayName="Alert";let c=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("h5",{ref:s,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));c.displayName="AlertTitle";let o=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",e),...t}));o.displayName="AlertDescription"},5818:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8495:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11107:(e,t,s)=>{"use strict";var r=s(96575);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},18262:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(20413).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\pstu_inventory_management\\\\frontend\\\\app\\\\admin\\\\requests\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\pstu_inventory_management\\frontend\\app\\admin\\requests\\page.tsx","default")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19205:(e,t,s)=>{"use strict";s.d(t,{E:()=>d});var r=s(28625);s(64996);var a=s(44714),i=s(36761);let l=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d({className:e,variant:t,...s}){return(0,r.jsx)("div",{className:(0,i.cn)(l({variant:t}),e),...s})}},23201:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},29234:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31802:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},33873:e=>{"use strict";e.exports=require("path")},43785:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},47887:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},51275:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},54979:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},58400:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]])},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65215:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]])},65700:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},72890:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},79344:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},79551:e=>{"use strict";e.exports=require("url")},84749:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},86389:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(33922).A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},89544:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,pages:()=>o,routeModule:()=>p,tree:()=>c});var r=s(5853),a=s(60554),i=s(30708),l=s.n(i),d=s(8067),n={};for(let e in d)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);s.d(t,n);let c={children:["",{children:["admin",{children:["requests",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,18262)),"D:\\pstu_inventory_management\\frontend\\app\\admin\\requests\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,87254)),"D:\\pstu_inventory_management\\frontend\\app\\admin\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,31077))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,97898)),"D:\\pstu_inventory_management\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,92192,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,82137,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,48358,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,31077))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,o=["D:\\pstu_inventory_management\\frontend\\app\\admin\\requests\\page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/admin/requests/page",pathname:"/admin/requests",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},91160:(e,t,s)=>{Promise.resolve().then(s.bind(s,18262))},98192:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(28625),a=s(64996),i=s(55136),l=s(19205),d=s(5106),n=s(47887),c=s(400),o=s(31802),u=s(5818),p=s(72890),m=s(8495),x=s(55918);let h="http://localhost:5000";function y(e){return null==e?"":String(e)}function f(e){return e?"string"==typeof e?e:"object"==typeof e&&"_id"in e?e._id:String(e):""}function b(e){let t=e.image_url||e.imageUrl||"",s="number"==typeof e.quantity?e.quantity:Number(e.quantity||0),r="number"==typeof e.unit_price?e.unit_price:Number(e.unit_price||0);"number"==typeof e.total_price?e.total_price:Number(e.total_price||s*r);let a=e.productName||e.itemName||`Item ${e.item_id||"(unknown)"}`,i=e.requestedById?.name||e.requestedByName||"Unknown User",l=e.requestedById?.email||void 0,d=f(e.requestedByUserId||e.requestedById?._id||e.user_id);return{...e,_id:y(e._id),productName:a,productSku:e.productSku||void 0,quantity:s,unitPrice:r,description:y(e.description),supplier:y(e.supplier||e.supplier_id),imageUrl:t,status:"approved"===e.status?"approved":"rejected"===e.status?"rejected":"pending",requestedByName:i,requestedByEmail:l,requestedByUserId:d,requestedAt:e.requested_at||e.createdAt||new Date().toISOString(),invoiceNo:e.invoice_no||e.invoiceNo||void 0}}function g(e){if(!e)return"/placeholder.svg";if(e.startsWith("http"))return e;let t=e.split("/").pop()||e;return`${h}/uploads/${t}`}async function v(e,t){let s=f(e.requestedByUserId||e.requestedById?._id||e.user_id);s||(s="system");let r=e.item_id||e.productSku||`ITEM-${e._id}`,a=e.supplier||e.supplier_id||"N/A",i="number"==typeof e.quantity?e.quantity:Number(e.quantity||0),l="number"==typeof e.unitPrice?e.unitPrice:"number"==typeof e.unit_price?e.unit_price:Number(e.unit_price||0),d="number"==typeof e.total_price?e.total_price:Number(e.total_price||0);if((!l||l<=0)&&d>0&&i>0&&(l=d/i),!i||i<=0)throw Error("Quantity must be greater than 0");if(!l||l<=0)throw Error("Valid unit price is required");let n=null,c=null;if(e.requestedById){let t=e.requestedById;(t.department_id||t.department)&&(n=t.department_id||t.department),(t.office_id||t.office)&&(c=t.office_id||t.office),t.role&&t.role}if(s&&"system"!==s&&(!n||!c))try{let e=await fetch(`${h}/api/users/get/${s}`);if(e.ok){let t=await e.json(),s=t.data||t.user||t;console.log("[v0] User data received:",JSON.stringify(s,null,2)),s.role,n=s.department_id||s.department||null,c=s.office_id||s.office||null}}catch(e){console.error("[v0] Error fetching user info:",e)}if(!n&&!c)throw Error(`Cannot create stock-in: requester has no department_id or office_id.
UserId: ${s}`);let o=e.invoiceNo||e.invoice_no||`${r}-${Date.now()}`,u={user_id:s,item_id:r,supplier_id:a,quantity:i,unit_price:l,total_price:i*l,purchase_date:new Date(e.requestedAt).toISOString().split("T")[0],invoice_no:o,department_id:n||"ok",office_id:c||"ok",remarks:`Stock request approved
Requested by: ${e.requestedByName||e.requestedById?.name||"N/A"}
Product: ${e.productName}
Description: ${e.description}`};console.log("createStockInEntry payload:",u);let p=await fetch(`${h}/api/stockins/create`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!p.ok){let e=`Failed to create stock-in: ${p.status}`;try{let t=await p.json();e=t.message||JSON.stringify(t)}catch(e){}throw Error(e)}let m=await p.json();return{invoiceNo:u.invoice_no,response:m}}function j(){let[e,t]=(0,a.useState)([]),[s,l]=(0,a.useState)(null),[p,m]=(0,a.useState)({}),[x,y]=(0,a.useState)({}),[f,g]=(0,a.useState)({}),[j,_]=(0,a.useState)(!0),[w,q]=(0,a.useState)(null),[A,M]=(0,a.useState)(null),[S,P]=(0,a.useState)(null),[B,R]=(0,a.useState)(0),[C,I]=(0,a.useState)(!1);(0,a.useRef)(null),(0,a.useRef)({items:new Set,suppliers:new Set,users:new Set});let $=e.filter(e=>"pending"===e.status),E=e.filter(e=>"approved"===e.status),U=e.filter(e=>"rejected"===e.status);async function D(e){M(e._id);try{let{invoiceNo:r}=await v(e),a=await fetch(`${h}/api/stockInRequest/update/${e._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"approved",reviewedByName:"Admin",adminNote:"Auto-approved with stock entry",invoiceNo:r})});if(!a.ok){let e=`Failed to update request: ${a.status}`;try{let t=await a.json();e=t.message||JSON.stringify(t)}catch(e){}throw Error(e)}let i=await a.json(),d=b(i);t(e=>e.map(e=>e._id===d._id?d:e)),s?._id===d._id&&l(d),q(null)}catch(e){console.error("onApprove error",e),q(e instanceof Error?e.message:"Failed to approve request")}finally{M(null)}}async function T(e){P(e._id);try{let r=await fetch(`${h}/api/stockInRequest/update/${e._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:"rejected",reviewedByName:"Admin",adminNote:"Rejected by admin"})});if(!r.ok)throw Error(`Failed to reject: ${r.status}`);let a=await r.json(),i=b(a);t(e=>e.map(e=>e._id===i._id?i:e)),s?._id===i._id&&l(i)}catch(e){console.error("onReject error",e),q(e instanceof Error?e.message:"Reject failed")}finally{P(null)}}return j?(0,r.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"h-12 w-12 border-4 border-slate-300 border-t-blue-600 rounded-full mx-auto mb-4 animate-spin"}),(0,r.jsx)("p",{className:"text-slate-600",children:"Loading stock requests..."})]})}):(0,r.jsxs)("main",{className:"min-h-screen bg-slate-50",children:[(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Stock Requests"}),(0,r.jsx)("p",{className:"text-slate-600",children:"Manage and review stock request submissions"})]}),w&&(0,r.jsxs)(d.Fc,{variant:"destructive",className:"mb-6",children:[(0,r.jsx)(n.A,{className:"h-4 w-4"}),(0,r.jsx)(d.TN,{children:w})]}),(0,r.jsxs)("section",{className:"mb-12",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"p-2 bg-amber-100 rounded-lg",children:(0,r.jsx)(c.A,{className:"h-6 w-6 text-amber-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900",children:["Pending Requests ",(0,r.jsxs)("span",{className:"text-amber-600",children:["(",$.length,")"]})]}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"Awaiting admin review"})]})]}),0===$.length?(0,r.jsx)(i.Zp,{className:"border-dashed border-slate-300 bg-white",children:(0,r.jsxs)(i.Wu,{className:"py-12 text-center",children:[(0,r.jsx)(c.A,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-slate-600 font-medium",children:"No pending requests at this time"})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:$.map(e=>(0,r.jsx)(k,{request:e,userData:f,itemNames:p,supplierNames:x,onClick:()=>l(e)},e._id))})]}),(0,r.jsxs)("section",{className:"mb-12",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"p-2 bg-green-100 rounded-lg",children:(0,r.jsx)(o.A,{className:"h-6 w-6 text-green-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900",children:["Approved Requests ",(0,r.jsxs)("span",{className:"text-green-600",children:["(",E.length,")"]})]}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"Successfully approved and ready"})]})]}),0===E.length?(0,r.jsx)(i.Zp,{className:"border-dashed border-slate-300 bg-white",children:(0,r.jsxs)(i.Wu,{className:"py-12 text-center",children:[(0,r.jsx)(o.A,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-slate-600 font-medium",children:"No approved requests yet"})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.map(e=>(0,r.jsx)(k,{request:e,userData:f,itemNames:p,supplierNames:x,onClick:()=>l(e)},e._id))})]}),(0,r.jsxs)("section",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"p-2 bg-red-100 rounded-lg",children:(0,r.jsx)(u.A,{className:"h-6 w-6 text-red-600"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900",children:["Rejected Requests ",(0,r.jsxs)("span",{className:"text-red-600",children:["(",U.length,")"]})]}),(0,r.jsx)("p",{className:"text-sm text-slate-600",children:"Declined requests"})]})]}),0===U.length?(0,r.jsx)(i.Zp,{className:"border-dashed border-slate-300 bg-white",children:(0,r.jsxs)(i.Wu,{className:"py-12 text-center",children:[(0,r.jsx)(u.A,{className:"h-12 w-12 text-slate-300 mx-auto mb-3"}),(0,r.jsx)("p",{className:"text-slate-600 font-medium",children:"No rejected requests"})]})}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:U.map(e=>(0,r.jsx)(k,{request:e,userData:f,itemNames:p,supplierNames:x,onClick:()=>l(e)},e._id))})]})]}),s&&(0,r.jsx)(N,{request:s,userData:f,itemNames:p,supplierNames:x,onClose:()=>l(null),onApprove:()=>{D(s)},onReject:()=>T(s),isApproving:A===s._id,isRejecting:S===s._id})]})}function N({request:e,userData:t,itemNames:s,supplierNames:a,onClose:i,onApprove:d,onReject:n,isApproving:c,isRejecting:o}){let u="pending"===e.status,h=e.requestedByUserId,y=h?t[h]:null,f=y?.name||e.requestedById?.name||e.requestedByName||"Unknown User",b=y?.email||e.requestedById?.email||e.requestedByEmail||"No email available",v=e.item_id?s[e.item_id]||e.item_id:"N/A",j=e.supplier?a[e.supplier]||e.supplier:"N/A";return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:i,children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-slate-200",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"sticky top-0 bg-slate-100 border-b border-slate-200 px-6 py-5 flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-slate-900 flex items-center gap-2",children:[(0,r.jsx)(p.A,{className:"h-6 w-6"})," ",v]}),(0,r.jsx)("button",{onClick:i,className:"text-slate-600 text-2xl font-bold",children:"\xd7"})]}),(0,r.jsxs)("div",{className:"p-6 space-y-6",children:[(0,r.jsx)("div",{className:"h-72 bg-slate-100 rounded border border-slate-200 overflow-hidden flex items-center justify-center",children:(0,r.jsx)("img",{src:g(e.imageUrl)||"/placeholder.svg",alt:e.productName,className:"w-full h-full object-cover",onError:e=>e.currentTarget.style.display="none"})}),(0,r.jsx)("div",{className:"border-b border-slate-200 pb-4",children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4 mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-3xl font-bold text-slate-900",children:e.productName}),(0,r.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"approved"===e.status&&e.invoiceNo?(0,r.jsxs)(r.Fragment,{children:["Invoice: ",e.invoiceNo]}):(0,r.jsx)(r.Fragment,{children:v})})]}),(0,r.jsx)(l.E,{className:`font-bold px-4 py-1 text-sm ${"approved"===e.status?"bg-green-500":"rejected"===e.status?"bg-red-500":"bg-amber-500"}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})}),(0,r.jsx)("div",{className:"bg-slate-50 p-5 rounded border border-slate-200",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)("div",{className:"p-3 bg-slate-200 rounded flex-shrink-0",children:(0,r.jsx)(m.A,{className:"h-6 w-6 text-slate-700"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-xs font-bold text-slate-600 uppercase tracking-wide",children:"Requested By"}),(0,r.jsx)("p",{className:"text-lg font-bold text-slate-900 mt-1",children:f}),(0,r.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:b})]})]})}),(0,r.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-lg",children:(0,r.jsx)("table",{className:"w-full",children:(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-slate-600 bg-slate-50 w-1/3",children:"Product Description"}),(0,r.jsx)("td",{className:"px-4 py-3 text-slate-900",children:e.description})]}),(0,r.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-slate-600 bg-slate-50",children:"Supplier"}),(0,r.jsx)("td",{className:"px-4 py-3 text-slate-900",children:j})]}),(0,r.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-slate-600 bg-slate-50",children:"Quantity"}),(0,r.jsxs)("td",{className:"px-4 py-3 text-slate-900 font-bold",children:[e.quantity," units"]})]}),(0,r.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-semibold text-slate-600 bg-slate-50",children:"Unit Price"}),(0,r.jsxs)("td",{className:"px-4 py-3 text-slate-900",children:["৳ ",e.unitPrice.toFixed(2)]})]}),(0,r.jsxs)("tr",{className:"bg-green-50",children:[(0,r.jsx)("td",{className:"px-4 py-3 text-sm font-bold text-green-700 bg-green-100",children:"Total Amount"}),(0,r.jsxs)("td",{className:"px-4 py-3 text-lg font-bold text-green-700",children:["৳ ",(e.quantity*e.unitPrice).toFixed(2)]})]})]})})}),(0,r.jsxs)("div",{className:"text-sm text-slate-600",children:[(0,r.jsx)("p",{className:"font-semibold",children:"Requested at:"}),(0,r.jsx)("p",{children:new Date(e.requestedAt).toLocaleString()})]}),u&&(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,r.jsx)(x.$,{onClick:()=>n&&n(),disabled:o,variant:"destructive",className:"flex-1",children:o?"Rejecting...":"Reject"}),(0,r.jsx)(x.$,{onClick:()=>d&&d(),disabled:c,className:"flex-1 bg-green-600 hover:bg-green-700",children:c?"Approving...":"Approve"})]})]})]})})}function k({request:e,userData:t,itemNames:s,supplierNames:a,onClick:d}){let n="approved"===e.status,c="rejected"===e.status,o=e.requestedByUserId,u=o?t[o]:null,p=u?.name||e.requestedById?.name||e.requestedByName||"Unknown",x=u?.email||e.requestedById?.email||e.requestedByEmail||"No email",h=e.item_id?s[e.item_id]||e.item_id:"N/A",y=e.supplier?a[e.supplier]||e.supplier:"N/A";return(0,r.jsxs)(i.Zp,{onClick:d,className:"overflow-hidden border border-slate-200 bg-white cursor-pointer",children:[(0,r.jsxs)("div",{className:"relative h-32 bg-slate-100 overflow-hidden flex items-center justify-center",children:[(0,r.jsx)("img",{src:g(e.imageUrl)||"/placeholder.svg",alt:e.productName,className:"w-full h-full object-cover",onError:e=>e.currentTarget.style.display="none"}),(0,r.jsx)("div",{className:"absolute top-2 right-2",children:(0,r.jsx)(l.E,{className:`font-semibold text-xs px-2 py-1 ${n?"bg-green-500":c?"bg-red-500":"bg-amber-500"}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})})]}),(0,r.jsxs)(i.aR,{className:"pb-2 border-b border-slate-100",children:[(0,r.jsx)(i.ZB,{className:"text-sm line-clamp-1 text-slate-900 font-bold",children:h}),(0,r.jsx)(i.BT,{className:"text-xs text-slate-500 line-clamp-1",children:e.productName})]}),(0,r.jsxs)(i.Wu,{className:"space-y-2 pt-3 pb-3",children:[(0,r.jsx)("div",{className:"bg-white p-2.5 rounded border border-slate-200",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"p-1.5 bg-slate-100 rounded-full flex-shrink-0",children:(0,r.jsx)(m.A,{className:"h-3 w-3 text-slate-600"})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("p",{className:"text-xs font-semibold text-slate-900 line-clamp-1",children:p}),(0,r.jsx)("p",{className:"text-xs text-slate-500 line-clamp-1",children:x})]})]})}),(0,r.jsxs)("div",{className:"bg-slate-50 p-2 rounded border border-slate-200 space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs",children:[(0,r.jsx)("span",{className:"text-slate-600 font-medium",children:"Qty:"}),(0,r.jsx)("span",{className:"font-bold text-slate-900",children:e.quantity})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-xs border-t border-slate-200 pt-1",children:[(0,r.jsx)("span",{className:"text-slate-600 font-bold",children:"Total:"}),(0,r.jsxs)("span",{className:"font-bold text-slate-900",children:["৳ ",(e.quantity*e.unitPrice).toFixed(2)]})]})]}),(0,r.jsxs)("div",{className:"text-xs",children:[(0,r.jsx)("p",{className:"text-slate-500 font-semibold mb-0.5",children:"Supplier"}),(0,r.jsx)("p",{className:"text-slate-900 font-medium line-clamp-1",children:y})]})]})]})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9683,9139,4405,8443],()=>s(89544));module.exports=r})();